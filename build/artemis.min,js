/*
 MIT license
 @link http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/21963136#21963136
*/
function CCLayer(){}function CCLayerColor(){}function CCNode(){}function CCSprite(){}function CCScene(){}var artemis;
(function(artemis){var utils;(function(utils){var Bag=function(){function Bag(capacity){if(capacity===void 0)capacity=64;this.size_=0;this.data_=new Array(capacity)}Bag.prototype.removeAt=function(index){var e=this.data_[index];this.data_[index]=this.data_[--this.size_];this.data_[this.size_]=null;return e};Bag.prototype.remove=function(e){var i;var e2;for(i=0;i<this.size_;i++){e2=this.data_[i];if(e==e2){this.data_[i]=this.data_[--this.size_];this.data_[this.size_]=null;return true}}return false};
Bag.prototype.removeLast=function(){if(this.size_>0){var e=this.data_[--this.size_];this.data_[this.size_]=null;return e}return null};Bag.prototype.contains=function(e){var i;for(i=0;this.size_>i;i++)if(e===this.data_[i])return true;return false};Bag.prototype.removeAll=function(bag){var modified=false;var i;var j;var e1;var e2;for(i=0;i<bag.size();i++){e1=bag.get(i);for(j=0;j<this.size_;j++){e2=this.data_[j];if(e1===e2){this.removeAt(j);j--;modified=true;break}}}return modified};Bag.prototype.get=
function(index){return this.data_[index]};Bag.prototype.size=function(){return this.size_};Bag.prototype.getCapacity=function(){return this.data_.length};Bag.prototype.isIndexWithinBounds=function(index){return index<this.getCapacity()};Bag.prototype.isEmpty=function(){return this.size_==0};Bag.prototype.add=function(e){if(this.size_===this.data_.length)this.grow();this.data_[this.size_++]=e};Bag.prototype.set=function(index,e){if(index>=this.data_.length)this.grow(index*2);this.size_=index+1;this.data_[index]=
e};Bag.prototype.grow=function(newCapacity){if(newCapacity===void 0)newCapacity=~~(this.data_.length*3/2)+1;this.data_.length=newCapacity};Bag.prototype.ensureCapacity=function(index){if(index>=this.data_.length)this.grow(index*2)};Bag.prototype.clear=function(){var i;for(i=0;i<this.size_;i++)this.data_[i]=null;this.size_=0};Bag.prototype.addAll=function(items){var i;for(i=0;items.size()>i;i++)this.add(items.get(i))};return Bag}();utils.Bag=Bag})(utils=artemis.utils||(artemis.utils={}))})(artemis||
(artemis={}));var artemis;
(function(artemis){var utils;(function(utils){var ADDRESS_BITS_PER_WORD=5;var BITS_PER_WORD=1<<ADDRESS_BITS_PER_WORD;var BIT_INDEX_MASK=BITS_PER_WORD-1;var WORD_MASK=4294967295;function numberOfTrailingZeros(i){if(i==0)return 64;var x=i;var y;var n=63;y=x<<32;if(y!=0){n-=32;x=y}y=x<<16;if(y!=0){n-=16;x=y}y=x<<8;if(y!=0){n-=8;x=y}y=x<<4;if(y!=0){n-=4;x=y}y=x<<2;if(y!=0){n-=2;x=y}return n-(x<<1>>>63)}var BitSet=function(){function BitSet(nbits){if(nbits===void 0)nbits=0;if(nbits<0)throw RangeError("Negative Array Size: ["+
nbits+"]");else if(nbits===0)this.words_=[];else{var words=this.words_=new Array((nbits-1>>ADDRESS_BITS_PER_WORD)+1);for(var i=0;i<words.length;i++)words[i]=0}}BitSet.prototype.nextSetBit=function(fromIndex){var u=fromIndex>>ADDRESS_BITS_PER_WORD;var words=this.words_;var wordsInUse=words.length;var word=words[u]&WORD_MASK<<fromIndex;while(true){if(word!=0)return u*BITS_PER_WORD+numberOfTrailingZeros(word);if(++u===wordsInUse)return-1;word=words[u]}};BitSet.prototype.intersects=function(set){var words=
this.words_;var wordsInUse=words.length;for(var i=Math.min(wordsInUse,set.words_.length)-1;i>=0;i--)if((words[i]&set.words_[i])!=0)return true;return false};BitSet.prototype.isEmpty=function(){return this.words_.length===0};BitSet.prototype.set=function(bitIndex,value){if(value===void 0)value=true;var wordIndex=bitIndex>>ADDRESS_BITS_PER_WORD;var words=this.words_;var wordsInUse=words.length;var wordsRequired=wordIndex+1;if(wordsInUse<wordsRequired){words.length=Math.max(2*wordsInUse,wordsRequired);
for(var i=wordsInUse;i<words.length;i++)words[i]=0}if(value)return words[wordIndex]|=1<<bitIndex;else return words[wordIndex]&=~(1<<bitIndex)};BitSet.prototype.get=function(bitIndex){var wordIndex=bitIndex>>ADDRESS_BITS_PER_WORD;var words=this.words_;var wordsInUse=words.length;return wordIndex<wordsInUse&&(words[wordIndex]&1<<bitIndex)!=0};BitSet.prototype.clear=function(bitIndex){if(bitIndex===null){var words=this.words_;var wordsInUse=words.length;while(wordsInUse>0)words[--wordsInUse]=0;return}var wordIndex=
bitIndex>>ADDRESS_BITS_PER_WORD;this.words_[wordIndex]&=~(1<<bitIndex)};return BitSet}();utils.BitSet=BitSet})(utils=artemis.utils||(artemis.utils={}))})(artemis||(artemis={}));var artemis;
(function(artemis){var utils;(function(utils){var MathUtils=function(){function MathUtils(){}MathUtils.nextBool=function(){return(~~(Math.random()*32767)&1)===1};MathUtils.nextDouble=function(){return Math.random()};MathUtils.nextInt=function(max){return~~(Math.random()*max)};MathUtils.random=function(start,end){if(end===null)return MathUtils.nextInt(start+1);else if(parseInt(start)===parseFloat(start)&&parseInt(end)===parseFloat(end))return start+MathUtils.nextInt(end-start+1);else return start+
MathUtils.nextDouble()*(end-start)};return MathUtils}();utils.MathUtils=MathUtils})(utils=artemis.utils||(artemis.utils={}))})(artemis||(artemis={}));var artemis;
(function(artemis){var utils;(function(utils){function decode(key){switch(typeof key){case "boolean":return""+key;case "number":return""+key;case "string":return key;case "function":return key.className|key.name;default:key.uuid=key.uuid?key.uuid:utils.UUID.randomUUID();return key.uuid}}var HashMap=function(){function HashMap(){this.clear()}HashMap.prototype.clear=function(){this.map_={};this.keys_={}};HashMap.prototype.values=function(){var result=[];for(var key in this.map_)result.push(this.map_[key]);
return result};HashMap.prototype.contains=function(value){for(var key in this.map_)if(value===this.map_[key])return true;return false};HashMap.prototype.containsKey=function(key){return decode(key)in this.map_};HashMap.prototype.containsValue=function(value){for(var key in this.map_)if(value===this.map_[key])return true;return false};HashMap.prototype.get=function(key){return this.map_[decode(key)]};HashMap.prototype.isEmpty=function(){return Object.keys(this.map_).length===0};HashMap.prototype.keys=
function(){var result=[];for(var key in this.keys_)result.push(this.keys_[key]);return result};HashMap.prototype.put=function(key,value){var k=decode(key);this.map_[k]=value;this.keys_[k]=key};HashMap.prototype.remove=function(key){var k=decode(key);delete this.map_[k];delete this.keys_[k]};HashMap.prototype.size=function(){return Object.keys(this.map_).length};return HashMap}();utils.HashMap=HashMap})(utils=artemis.utils||(artemis.utils={}))})(artemis||(artemis={}));
var Randum=function(){function Randum(){}Randum.prototype.nextBool=function(){return(~~(Math.random()*32767)&1)===1};Randum.prototype.nextDouble=function(){return Math.random()};Randum.prototype.nextInt=function(max){return~~(Math.random()*max)};return Randum}();var artemis;
(function(artemis){var utils;(function(utils){var Timer=function(){function Timer(delay,repeat){if(repeat===void 0)repeat=false;this.execute=function(){};this.delay=delay;this.repeat=repeat;this.acc=0}Timer.prototype.update=function(delta){if(!this.done&&!this.stopped){this.acc+=delta;if(this.acc>=this.delay){this.acc-=this.delay;if(this.repeat)this.reset();else this.done=true;this.execute()}}};Timer.prototype.reset=function(){this.stopped=false;this.done=false;this.acc=0};Timer.prototype.isDone=
function(){return this.done};Timer.prototype.isRunning=function(){return!this.done&&this.acc<this.delay&&!this.stopped};Timer.prototype.stop=function(){this.stopped=true};Timer.prototype.setDelay=function(delay){this.delay=delay};Timer.prototype.getPercentageRemaining=function(){if(this.done)return 100;else if(this.stopped)return 0;else return 1-(this.delay-this.acc)/this.delay};Timer.prototype.getDelay=function(){return this.delay};return Timer}();utils.Timer=Timer})(utils=artemis.utils||(artemis.utils=
{}))})(artemis||(artemis={}));var artemis;
(function(artemis){var utils;(function(utils){var lut=[];for(var i=0;i<256;i++)lut[i]=(i<16?"0":"")+i.toString(16);var UUID=function(){function UUID(){}UUID.randomUUID=function(){var d0=Math.random()*4294967295|0;var d1=Math.random()*4294967295|0;var d2=Math.random()*4294967295|0;var d3=Math.random()*4294967295|0;var uuid=lut[d0&255]+lut[d0>>8&255]+lut[d0>>16&255]+lut[d0>>24&255]+"-"+lut[d1&255]+lut[d1>>8&255]+"-"+lut[d1>>16&15|64]+lut[d1>>24&255]+"-"+lut[d2&63|128]+lut[d2>>8&255]+"-"+lut[d2>>16&
255]+lut[d2>>24&255]+lut[d3&255]+lut[d3>>8&255]+lut[d3>>16&255]+lut[d3>>24&255];if(uuid in UUID.check)throw new Error("Duplicate uuid ["+uuid+"]");UUID.check[uuid]=uuid;return uuid};UUID.check={};return UUID}();utils.UUID=UUID})(utils=artemis.utils||(artemis.utils={}))})(artemis||(artemis={}));var artemis;
(function(artemis){var annotations;(function(annotations){function Mapper(component){return function(target,propertyKey,descriptor){var klass=target.constructor;klass.declaredFields=klass.declaredFields||[];klass.declaredFields.push(propertyKey);klass.prototype[propertyKey]=component}}annotations.Mapper=Mapper})(annotations=artemis.annotations||(artemis.annotations={}))})(artemis||(artemis={}));var artemis;
(function(artemis){var Component=function(){function Component(){}return Component}();artemis.Component=Component})(artemis||(artemis={}));var artemis;
(function(artemis){var BitSet=artemis.utils.BitSet;var Aspect=function(){function Aspect(){this.allSet_=new BitSet;this.exclusionSet_=new BitSet;this.oneSet_=new BitSet}Aspect.prototype.getAllSet=function(){return this.allSet_};Aspect.prototype.getExclusionSet=function(){return this.exclusionSet_};Aspect.prototype.getOneSet=function(){return this.oneSet_};Aspect.prototype.all=function(type){var types=[];for(var _i=1;_i<arguments.length;_i++)types[_i-1]=arguments[_i];this.allSet_.set(artemis.ComponentType.getIndexFor(type));
for(var t in types)this.allSet_.set(artemis.ComponentType.getIndexFor(types[t]));return this};Aspect.prototype.exclude=function(type){var types=[];for(var _i=1;_i<arguments.length;_i++)types[_i-1]=arguments[_i];this.exclusionSet_.set(artemis.ComponentType.getIndexFor(type));for(var t in types)this.exclusionSet_.set(artemis.ComponentType.getIndexFor(types[t]));return this};Aspect.prototype.one=function(type){var types=[];for(var _i=1;_i<arguments.length;_i++)types[_i-1]=arguments[_i];this.oneSet_.set(artemis.ComponentType.getIndexFor(type));
for(var t in types)this.oneSet_.set(artemis.ComponentType.getIndexFor(types[t]));return this};Aspect.getAspectFor=function(type){var types=[];for(var _i=1;_i<arguments.length;_i++)types[_i-1]=arguments[_i];return Aspect.getAspectForAll.apply(Aspect,[type].concat(types))};Aspect.getAspectForAll=function(type){var types=[];for(var _i=1;_i<arguments.length;_i++)types[_i-1]=arguments[_i];var aspect=new Aspect;aspect.all.apply(aspect,[type].concat(types));return aspect};Aspect.getAspectForOne=function(type){var types=
[];for(var _i=1;_i<arguments.length;_i++)types[_i-1]=arguments[_i];var aspect=new Aspect;aspect.one.apply(aspect,[type].concat(types));return aspect};Aspect.getEmpty=function(){return new Aspect};return Aspect}();artemis.Aspect=Aspect})(artemis||(artemis={}));var artemis;
(function(artemis){var BitSet=artemis.utils.BitSet;var UUID=artemis.utils.UUID;var Entity=function(){function Entity(world,id){this.world_=world;this.id_=id;this.entityManager_=world.getEntityManager();this.componentManager_=world.getComponentManager();this.systemBits_=new BitSet;this.componentBits_=new BitSet;this.reset()}Entity.prototype.getId=function(){return this.id_};Entity.prototype.getComponentBits=function(){return this.componentBits_};Entity.prototype.getSystemBits=function(){return this.systemBits_};
Entity.prototype.reset=function(){this.systemBits_.clear();this.componentBits_.clear();this.uuid=UUID.randomUUID()};Entity.prototype.toString=function(){return"Entity["+this.id_+"]"};Entity.prototype.addComponent=function(component,type){if(type===void 0)type=artemis.ComponentType.getTypeFor(component.constructor);this.componentManager_.addComponent(this,type,component);return this};Entity.prototype.removeComponentInstance=function(component){this.removeComponent(artemis.ComponentType.getTypeFor(component.constructor));
return this};Entity.prototype.removeComponent=function(type){this.componentManager_.removeComponent(this,type);return this};Entity.prototype.removeComponentByType=function(type){this.removeComponent(artemis.ComponentType.getTypeFor(type));return this};Entity.prototype.isActive=function(){return this.entityManager_.isActive(this.id_)};Entity.prototype.isEnabled=function(){return this.entityManager_.isEnabled(this.id_)};Entity.prototype.getComponent=function(type){return this.componentManager_.getComponent(this,
type)};Entity.prototype.getComponentSlow=function(type){return this.componentManager_.getComponent(this,artemis.ComponentType.getTypeFor(type))};Entity.prototype.getComponents=function(fillBag){return this.componentManager_.getComponentsFor(this,fillBag)};Entity.prototype.addToWorld=function(){this.world_.addEntity(this)};Entity.prototype.changedInWorld=function(){this.world_.changedEntity(this)};Entity.prototype.deleteFromWorld=function(){this.world_.deleteEntity(this)};Entity.prototype.enable=function(){this.world_.enable(this)};
Entity.prototype.disable=function(){this.world_.disable(this)};Entity.prototype.getUuid=function(){return this.uuid};Entity.prototype.getWorld=function(){return this.world_};return Entity}();artemis.Entity=Entity})(artemis||(artemis={}));var artemis;
(function(artemis){var Manager=function(){function Manager(){}Manager.prototype.initialize=function(){};Manager.prototype.setWorld=function(world){this.world_=world};Manager.prototype.getWorld=function(){return this.world_};Manager.prototype.added=function(e){};Manager.prototype.changed=function(e){};Manager.prototype.deleted=function(e){};Manager.prototype.disabled=function(e){};Manager.prototype.enabled=function(e){};return Manager}();artemis.Manager=Manager})(artemis||(artemis={}));var artemis;
(function(artemis){var Bag=artemis.utils.Bag;var HashMap=artemis.utils.HashMap;var World=function(){function World(){this.managers_=new HashMap;this.managersBag_=new Bag;this.systems_=new HashMap;this.systemsBag_=new Bag;this.added_=new Bag;this.changed_=new Bag;this.deleted_=new Bag;this.enable_=new Bag;this.disable_=new Bag;this.cm_=new artemis.ComponentManager;this.setManager(this.cm_);this.em_=new artemis.EntityManager;this.setManager(this.em_)}World.prototype.initialize=function(){for(var i=
0;i<this.managersBag_.size();i++)this.managersBag_.get(i).initialize();for(var i=0;i<this.systemsBag_.size();i++){ComponentMapperInitHelper.config(this.systemsBag_.get(i),this);this.systemsBag_.get(i).initialize()}};World.prototype.getEntityManager=function(){return this.em_};World.prototype.getComponentManager=function(){return this.cm_};World.prototype.setManager=function(manager){this.managers_.put(manager.constructor,manager);this.managersBag_.add(manager);manager.setWorld(this);return manager};
World.prototype.getManager=function(managerType){return this.managers_.get(managerType)};World.prototype.deleteManager=function(manager){this.managers_.remove(manager);this.managersBag_.remove(manager)};World.prototype.getDelta=function(){return this.delta};World.prototype.setDelta=function(delta){this.delta=delta};World.prototype.addEntity=function(e){this.added_.add(e)};World.prototype.changedEntity=function(e){this.changed_.add(e)};World.prototype.deleteEntity=function(e){if(!this.deleted_.contains(e))this.deleted_.add(e)};
World.prototype.enable=function(e){this.enable_.add(e)};World.prototype.disable=function(e){this.disable_.add(e)};World.prototype.createEntity=function(){return this.em_.createEntityInstance()};World.prototype.getEntity=function(entityId){return this.em_.getEntity(entityId)};World.prototype.getSystems=function(){return this.systemsBag_};World.prototype.setSystem=function(system,passive){if(passive===void 0)passive=false;system.setWorld(this);system.setPassive(passive);this.systems_.put(system.constructor,
system);this.systemsBag_.add(system);return system};World.prototype.deleteSystem=function(system){this.systems_.remove(system.constructor);this.systemsBag_.remove(system)};World.prototype.notifySystems=function(performer,e){for(var i=0,s=this.systemsBag_.size();s>i;i++)performer.perform(this.systemsBag_.get(i),e)};World.prototype.notifyManagers=function(performer,e){for(var a=0;this.managersBag_.size()>a;a++)performer.perform(this.managersBag_.get(a),e)};World.prototype.getSystem=function(type){return this.systems_.get(type)};
World.prototype.check=function(entities,performer){if(!entities.isEmpty()){for(var i=0;entities.size()>i;i++){var e=entities.get(i);this.notifyManagers(performer,e);this.notifySystems(performer,e)}entities.clear()}};World.prototype.process=function(){this.check(this.added_,{perform:function(observer,e){observer.added(e)}});this.check(this.changed_,{perform:function(observer,e){observer.changed(e)}});this.check(this.disable_,{perform:function(observer,e){observer.disabled(e)}});this.check(this.enable_,
{perform:function(observer,e){observer.enabled(e)}});this.check(this.deleted_,{perform:function(observer,e){observer.deleted(e)}});this.cm_.clean();for(var i=0;this.systemsBag_.size()>i;i++){var system=this.systemsBag_.get(i);if(!system.isPassive())system.process()}};World.prototype.getMapper=function(type){return artemis.ComponentMapper.getFor(type,this)};return World}();artemis.World=World;var ComponentMapperInitHelper=function(){function ComponentMapperInitHelper(){}ComponentMapperInitHelper.config=
function(target,world){try{var clazz=target.constructor;var className=clazz.className||clazz.name;for(var fieldIndex in clazz.declaredFields){var field=clazz.declaredFields[fieldIndex];if(!target.hasOwnProperty(field)){var componentType=clazz.prototype[field];target[field]=world.getMapper(componentType)}}}catch(e){throw new Error("Error while setting component mappers");}};return ComponentMapperInitHelper}()})(artemis||(artemis={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var Bag=artemis.utils.Bag;var Manager=artemis.Manager;var ComponentManager=function(_super){__extends(ComponentManager,_super);function ComponentManager(){_super.call(this);this.componentsByType_=new Bag;this.deleted_=new Bag}ComponentManager.prototype.initialize=function(){};ComponentManager.prototype.removeComponentsOfEntity=function(e){var componentBits=e.getComponentBits();for(var i=componentBits.nextSetBit(0);i>=0;i=componentBits.nextSetBit(i+1))this.componentsByType_.get(i).set(e.getId(),
null);componentBits.clear()};ComponentManager.prototype.addComponent=function(e,type,component){this.componentsByType_.ensureCapacity(type.getIndex());var components=this.componentsByType_.get(type.getIndex());if(components==null){components=new Bag;this.componentsByType_.set(type.getIndex(),components)}components.set(e.getId(),component);e.getComponentBits().set(type.getIndex())};ComponentManager.prototype.removeComponent=function(e,type){if(e.getComponentBits().get(type.getIndex())){this.componentsByType_.get(type.getIndex()).set(e.getId(),
null);e.getComponentBits().clear(type.getIndex())}};ComponentManager.prototype.getComponentsByType=function(type){var components=this.componentsByType_.get(type.getIndex());if(components==null){components=new Bag;this.componentsByType_.set(type.getIndex(),components)}return components};ComponentManager.prototype.getComponent=function(e,type){var components=this.componentsByType_.get(type.getIndex());if(components!=null)return components.get(e.getId());return null};ComponentManager.prototype.getComponentsFor=
function(e,fillBag){var componentBits=e.getComponentBits();for(var i=componentBits.nextSetBit(0);i>=0;i=componentBits.nextSetBit(i+1))fillBag.add(this.componentsByType_.get(i).get(e.getId()));return fillBag};ComponentManager.prototype.deleted=function(e){this.deleted_.add(e)};ComponentManager.prototype.clean=function(){if(this.deleted_.size()>0){for(var i=0;this.deleted_.size()>i;i++)this.removeComponentsOfEntity(this.deleted_.get(i));this.deleted_.clear()}};return ComponentManager}(Manager);artemis.ComponentManager=
ComponentManager})(artemis||(artemis={}));var artemis;
(function(artemis){var HashMap=artemis.utils.HashMap;var ComponentType=function(){function ComponentType(type){this.index_=ComponentType.INDEX++;this.type_=type}ComponentType.prototype.getIndex=function(){return this.index_};ComponentType.prototype.toString=function(){var klass=ComponentType;return"ComponentType["+klass.name+"] ("+this.index_+")"};ComponentType.getTypeFor=function(c){var type=ComponentType.componentTypes.get(c);if(type==null){type=new ComponentType(c);ComponentType.componentTypes.put(c,
type)}return type};ComponentType.getIndexFor=function(c){return ComponentType.getTypeFor(c).getIndex()};ComponentType.INDEX=0;ComponentType.componentTypes=new HashMap;return ComponentType}();artemis.ComponentType=ComponentType})(artemis||(artemis={}));var artemis;
(function(artemis){var ComponentType=artemis.ComponentType;var ComponentMapper=function(){function ComponentMapper(type,world){this.type_=ComponentType.getTypeFor(type);this.components_=world.getComponentManager().getComponentsByType(this.type_);this.classType_=type}ComponentMapper.prototype.get=function(e){return this.components_.get(e.getId())};ComponentMapper.prototype.getSafe=function(e){if(this.components_.isIndexWithinBounds(e.getId()))return this.components_.get(e.getId());return null};ComponentMapper.prototype.has=
function(e){return this.getSafe(e)!=null};ComponentMapper.getFor=function(type,world){return new ComponentMapper(type,world)};return ComponentMapper}();artemis.ComponentMapper=ComponentMapper})(artemis||(artemis={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var Bag=artemis.utils.Bag;var BitSet=artemis.utils.BitSet;var Manager=artemis.Manager;var EntityManager=function(_super){__extends(EntityManager,_super);function EntityManager(){_super.call(this);this.entities_=new Bag;this.disabled_=new BitSet;this.identifierPool_=new IdentifierPool}EntityManager.prototype.initialize=function(){};EntityManager.prototype.createEntityInstance=function(){var e=new artemis.Entity(this.world_,this.identifierPool_.checkOut());this.created_++;return e};
EntityManager.prototype.added=function(e){this.active_++;this.added_++;this.entities_.set(e.getId(),e)};EntityManager.prototype.enabled=function(e){this.disabled_.clear(e.getId())};EntityManager.prototype.disabled=function(e){this.disabled_.set(e.getId())};EntityManager.prototype.deleted=function(e){this.entities_.set(e.getId(),null);this.disabled_.clear(e.getId());this.identifierPool_.checkIn(e.getId());this.active_--;this.deleted_++};EntityManager.prototype.isActive=function(entityId){return this.entities_.get(entityId)!=
null};EntityManager.prototype.isEnabled=function(entityId){return!this.disabled_.get(entityId)};EntityManager.prototype.getEntity=function(entityId){return this.entities_.get(entityId)};EntityManager.prototype.getActiveEntityCount=function(){return this.active_};EntityManager.prototype.getTotalCreated=function(){return this.created_};EntityManager.prototype.getTotalAdded=function(){return this.added_};EntityManager.prototype.getTotalDeleted=function(){return this.deleted_};return EntityManager}(Manager);
artemis.EntityManager=EntityManager;var IdentifierPool=function(){function IdentifierPool(){this.nextAvailableId_=0;this.ids_=new Bag}IdentifierPool.prototype.checkOut=function(){if(this.ids_.size()>0)return this.ids_.removeLast();return this.nextAvailableId_++};IdentifierPool.prototype.checkIn=function(id){this.ids_.add(id)};return IdentifierPool}()})(artemis||(artemis={}));var artemis;
(function(artemis){var Bag=artemis.utils.Bag;var HashMap=artemis.utils.HashMap;var EntitySystem=function(){function EntitySystem(aspect){this.actives_=new Bag;this.aspect_=aspect;this.allSet_=aspect.getAllSet();this.exclusionSet_=aspect.getExclusionSet();this.oneSet_=aspect.getOneSet();this.systemIndex_=SystemIndexManager.getIndexFor(this.constructor);this.dummy_=this.allSet_.isEmpty()&&this.oneSet_.isEmpty()}EntitySystem.prototype.begin=function(){};EntitySystem.prototype.process=function(){if(this.checkProcessing()){this.begin();
this.processEntities(this.actives_);this.end()}};EntitySystem.prototype.end=function(){};EntitySystem.prototype.processEntities=function(entities){};EntitySystem.prototype.checkProcessing=function(){return true};EntitySystem.prototype.initialize=function(){};EntitySystem.prototype.inserted=function(e){};EntitySystem.prototype.removed=function(e){};EntitySystem.prototype.check=function(e){if(this.dummy_)return;var unc=this.constructor;var contains=e.getSystemBits().get(this.systemIndex_);var interested=
true;var componentBits=e.getComponentBits();if(!this.allSet_.isEmpty())for(var i=this.allSet_.nextSetBit(0);i>=0;i=this.allSet_.nextSetBit(i+1))if(!componentBits.get(i)){interested=false;break}if(!this.exclusionSet_.isEmpty()&&interested)interested=!this.exclusionSet_.intersects(componentBits);if(!this.oneSet_.isEmpty())interested=this.oneSet_.intersects(componentBits);if(interested&&!contains)this.insertToSystem(e);else if(!interested&&contains)this.removeFromSystem(e)};EntitySystem.prototype.removeFromSystem=
function(e){this.actives_.remove(e);e.getSystemBits().clear(this.systemIndex_);this.removed(e)};EntitySystem.prototype.insertToSystem=function(e){this.actives_.add(e);e.getSystemBits().set(this.systemIndex_);this.inserted(e)};EntitySystem.prototype.added=function(e){this.check(e)};EntitySystem.prototype.changed=function(e){this.check(e)};EntitySystem.prototype.deleted=function(e){if(e.getSystemBits().get(this.systemIndex_))this.removeFromSystem(e)};EntitySystem.prototype.disabled=function(e){if(e.getSystemBits().get(this.systemIndex_))this.removeFromSystem(e)};
EntitySystem.prototype.enabled=function(e){this.check(e)};EntitySystem.prototype.setWorld=function(world){this.world=world};EntitySystem.prototype.isPassive=function(){return this.passive_};EntitySystem.prototype.setPassive=function(passive){this.passive_=passive};EntitySystem.prototype.getActives=function(){return this.actives_};return EntitySystem}();artemis.EntitySystem=EntitySystem;var SystemIndexManager=function(){function SystemIndexManager(){}SystemIndexManager.getIndexFor=function(es){var index=
SystemIndexManager.indices.get(es);if(index==null){index=SystemIndexManager.INDEX++;SystemIndexManager.indices.put(es,index)}return index};SystemIndexManager.INDEX=0;SystemIndexManager.indices=new HashMap;return SystemIndexManager}()})(artemis||(artemis={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var Bag=artemis.utils.Bag;var HashMap=artemis.utils.HashMap;var Manager=artemis.Manager;var managers;(function(managers){var GroupManager=function(_super){__extends(GroupManager,_super);function GroupManager(){_super.call(this);this.entitiesByGroup_=new HashMap;this.groupsByEntity_=new HashMap}GroupManager.prototype.initialize=function(){};GroupManager.prototype.add=function(e,group){var entities=this.entitiesByGroup_.get(group);if(entities==null){entities=new Bag;this.entitiesByGroup_.put(group,
entities)}entities.add(e);var groups=this.groupsByEntity_.get(e);if(groups==null){groups=new Bag;this.groupsByEntity_.put(e,groups)}groups.add(group)};GroupManager.prototype.remove=function(e,group){var entities=this.entitiesByGroup_.get(group);if(entities!=null)entities.remove(e);var groups=this.groupsByEntity_.get(e);if(groups!=null)groups.remove(group)};GroupManager.prototype.removeFromAllGroups=function(e){var groups=this.groupsByEntity_.get(e);if(groups!=null){for(var i=0;groups.size()>i;i++){var entities=
this.entitiesByGroup_.get(groups.get(i));if(entities!=null)entities.remove(e)}groups.clear()}};GroupManager.prototype.getEntities=function(group){var entities=this.entitiesByGroup_.get(group);if(entities==null){entities=new Bag;this.entitiesByGroup_.put(group,entities)}return entities};GroupManager.prototype.getGroups=function(e){return this.groupsByEntity_.get(e)};GroupManager.prototype.isInAnyGroup=function(e){return this.getGroups(e)!=null};GroupManager.prototype.isInGroup=function(e,group){if(group!=
null){var groups=this.groupsByEntity_.get(e);for(var i=0;groups.size()>i;i++){var g=groups.get(i);if(group===g)return true}}return false};GroupManager.prototype.deleted=function(e){this.removeFromAllGroups(e)};return GroupManager}(Manager);managers.GroupManager=GroupManager})(managers=artemis.managers||(artemis.managers={}))})(artemis||(artemis={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var Bag=artemis.utils.Bag;var HashMap=artemis.utils.HashMap;var Manager=artemis.Manager;var managers;(function(managers){var PlayerManager=function(_super){__extends(PlayerManager,_super);function PlayerManager(){_super.call(this);this.playerByEntity_=new HashMap;this.entitiesByPlayer_=new HashMap}PlayerManager.prototype.setPlayer=function(e,player){this.playerByEntity_.put(e,player);var entities=this.entitiesByPlayer_.get(player);if(entities==null){entities=new Bag;this.entitiesByPlayer_.put(player,
entities)}entities.add(e)};PlayerManager.prototype.getEntitiesOfPlayer=function(player){var entities=this.entitiesByPlayer_.get(player);if(entities==null)entities=new Bag;return entities};PlayerManager.prototype.removeFromPlayer=function(e){var player=this.playerByEntity_.get(e);if(player!==null){var entities=this.entitiesByPlayer_.get(player);if(entities!==null)entities.remove(e)}};PlayerManager.prototype.getPlayer=function(e){return this.playerByEntity_.get(e)};PlayerManager.prototype.initialize=
function(){};PlayerManager.prototype.deleted=function(e){this.removeFromPlayer(e)};return PlayerManager}(Manager);managers.PlayerManager=PlayerManager})(managers=artemis.managers||(artemis.managers={}))})(artemis||(artemis={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var managers;(function(managers){var HashMap=artemis.utils.HashMap;var Manager=artemis.Manager;var TagManager=function(_super){__extends(TagManager,_super);function TagManager(){_super.call(this);this.entitiesByTag_=new HashMap;this.tagsByEntity_=new HashMap}TagManager.prototype.register=function(tag,e){this.entitiesByTag_.put(tag,e);this.tagsByEntity_.put(e,tag)};TagManager.prototype.unregister=function(tag){this.tagsByEntity_.remove(this.entitiesByTag_.remove(tag))};TagManager.prototype.isRegistered=
function(tag){return this.entitiesByTag_.containsKey(tag)};TagManager.prototype.getEntity=function(tag){return this.entitiesByTag_.get(tag)};TagManager.prototype.getRegisteredTags=function(){return this.tagsByEntity_.values()};TagManager.prototype.deleted=function(e){var removedTag=this.tagsByEntity_.remove(e);if(removedTag!=null)this.entitiesByTag_.remove(removedTag)};TagManager.prototype.initialize=function(){};return TagManager}(Manager);managers.TagManager=TagManager})(managers=artemis.managers||
(artemis.managers={}))})(artemis||(artemis={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var Bag=artemis.utils.Bag;var HashMap=artemis.utils.HashMap;var Manager=artemis.Manager;var managers;(function(managers){var TeamManager=function(_super){__extends(TeamManager,_super);function TeamManager(){_super.call(this);this.playersByTeam_=new HashMap;this.teamByPlayer_=new HashMap}TeamManager.prototype.initialize=function(){};TeamManager.prototype.getTeam=function(player){return this.teamByPlayer_.get(player)};TeamManager.prototype.setTeam=function(player,team){this.removeFromTeam(player);
this.teamByPlayer_.put(player,team);var players=this.playersByTeam_.get(team);if(players==null){players=new Bag;this.playersByTeam_.put(team,players)}players.add(player)};TeamManager.prototype.getPlayers=function(team){return this.playersByTeam_.get(team)};TeamManager.prototype.removeFromTeam=function(player){var team=this.teamByPlayer_.remove(player);if(team!=null){var players=this.playersByTeam_.get(team);if(players!=null)players.remove(player)}};return TeamManager}(Manager);managers.TeamManager=
TeamManager})(managers=artemis.managers||(artemis.managers={}))})(artemis||(artemis={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var systems;(function(systems){var EntitySystem=artemis.EntitySystem;var DelayedEntityProcessingSystem=function(_super){__extends(DelayedEntityProcessingSystem,_super);function DelayedEntityProcessingSystem(aspect){_super.call(this,aspect)}DelayedEntityProcessingSystem.prototype.processEntities=function(entities){for(var i=0,s=entities.size();s>i;i++){var entity=entities.get(i);this.processDelta(entity,this.acc_);var remaining=this.getRemainingDelay(entity);if(remaining<=0)this.processExpired(entity);
else this.offerDelay(remaining)}this.stop()};DelayedEntityProcessingSystem.prototype.inserted=function(e){var delay=this.getRemainingDelay(e);if(delay>0)this.offerDelay(delay)};DelayedEntityProcessingSystem.prototype.getRemainingDelay=function(e){throw Error("Abstract Method");};DelayedEntityProcessingSystem.prototype.checkProcessing=function(){if(this.running_){this.acc_+=this.world.getDelta();if(this.acc_>=this.delay_)return true}return false};DelayedEntityProcessingSystem.prototype.processDelta=
function(e,accumulatedDelta){};DelayedEntityProcessingSystem.prototype.processExpired=function(e){};DelayedEntityProcessingSystem.prototype.restart=function(delay){this.delay_=delay;this.acc_=0;this.running_=true};DelayedEntityProcessingSystem.prototype.offerDelay=function(delay){if(!this.running_||delay<this.getRemainingTimeUntilProcessing())this.restart(delay)};DelayedEntityProcessingSystem.prototype.getInitialTimeDelay=function(){return this.delay_};DelayedEntityProcessingSystem.prototype.getRemainingTimeUntilProcessing=
function(){if(this.running_)return this.delay_-this.acc_;return 0};DelayedEntityProcessingSystem.prototype.isRunning=function(){return this.running_};DelayedEntityProcessingSystem.prototype.stop=function(){this.running_=false;this.acc_=0};return DelayedEntityProcessingSystem}(EntitySystem);systems.DelayedEntityProcessingSystem=DelayedEntityProcessingSystem})(systems=artemis.systems||(artemis.systems={}))})(artemis||(artemis={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var systems;(function(systems){var EntitySystem=artemis.EntitySystem;var EntityProcessingSystem=function(_super){__extends(EntityProcessingSystem,_super);function EntityProcessingSystem(aspect){_super.call(this,aspect)}EntityProcessingSystem.prototype.processEach=function(e){};EntityProcessingSystem.prototype.processEntities=function(entities){for(var i=0,s=entities.size();s>i;i++)this.processEach(entities.get(i))};EntityProcessingSystem.prototype.checkProcessing=function(){return true};
return EntityProcessingSystem}(EntitySystem);systems.EntityProcessingSystem=EntityProcessingSystem})(systems=artemis.systems||(artemis.systems={}))})(artemis||(artemis={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var systems;(function(systems){var EntitySystem=artemis.EntitySystem;var IntervalEntitySystem=function(_super){__extends(IntervalEntitySystem,_super);function IntervalEntitySystem(aspect,interval){_super.call(this,aspect);this.interval_=interval}IntervalEntitySystem.prototype.checkProcessing=function(){this.acc_+=this.world.getDelta();if(this.acc_>=this.interval_){this.acc_-=this.interval_;return true}return false};return IntervalEntitySystem}(EntitySystem);systems.IntervalEntitySystem=
IntervalEntitySystem})(systems=artemis.systems||(artemis.systems={}))})(artemis||(artemis={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var systems;(function(systems){var EntitySystem=artemis.EntitySystem;var Aspect=artemis.Aspect;var VoidEntitySystem=function(_super){__extends(VoidEntitySystem,_super);function VoidEntitySystem(){_super.call(this,Aspect.getEmpty())}VoidEntitySystem.prototype.processEntities=function(entities){this.processSystem()};VoidEntitySystem.prototype.processSystem=function(){};VoidEntitySystem.prototype.checkProcessing=function(){return true};return VoidEntitySystem}(EntitySystem);systems.VoidEntitySystem=
VoidEntitySystem})(systems=artemis.systems||(artemis.systems={}))})(artemis||(artemis={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var systems;(function(systems){var IntervalEntitySystem=artemis.systems.IntervalEntitySystem;var IntervalEntityProcessingSystem=function(_super){__extends(IntervalEntityProcessingSystem,_super);function IntervalEntityProcessingSystem(aspect,interval){_super.call(this,aspect,interval)}IntervalEntityProcessingSystem.prototype.processEach=function(e){};IntervalEntityProcessingSystem.prototype.processEntities=function(entities){for(var i=0,s=entities.size();s>i;i++)this.processEach(entities.get(i))};
return IntervalEntityProcessingSystem}(IntervalEntitySystem);systems.IntervalEntityProcessingSystem=IntervalEntityProcessingSystem})(systems=artemis.systems||(artemis.systems={}))})(artemis||(artemis={}));(function(root,factory){if("function"===typeof define&&undefined.amd)define(factory);else if("object"==typeof exports)module.exports=factory();else root["artemis"]=factory()})(this,function(){return artemis});
