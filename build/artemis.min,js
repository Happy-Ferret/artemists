/*
 MIT license
 @link http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/21963136#21963136
*/
function CCLayer(){}function CCLayerColor(){}function CCNode(){}function CCSprite(){}function CCScene(){}var artemis;
(function(artemis){var utils;(function(utils){var Bag=function(){function Bag(capacity){if(capacity===void 0)capacity=64;this.size_=0;this.data_=new Array(capacity)}Bag.prototype.removeAt=function(index){var e=this.data_[index];this.data_[index]=this.data_[--this.size_];this.data_[this.size_]=null;return e};Bag.prototype.remove=function(e){var i;var e2;for(i=0;i<this.size_;i++){e2=this.data_[i];if(e==e2){this.data_[i]=this.data_[--this.size_];this.data_[this.size_]=null;return true}}return false};
Bag.prototype.removeLast=function(){if(this.size_>0){var e=this.data_[--this.size_];this.data_[this.size_]=null;return e}return null};Bag.prototype.contains=function(e){var i;for(i=0;this.size_>i;i++)if(e===this.data_[i])return true;return false};Bag.prototype.removeAll=function(bag){var modified=false;var i;var j;var e1;var e2;for(i=0;i<bag.size();i++){e1=bag.get(i);for(j=0;j<this.size_;j++){e2=this.data_[j];if(e1===e2){this.removeAt(j);j--;modified=true;break}}}return modified};Bag.prototype.get=
function(index){return this.data_[index]};Bag.prototype.size=function(){return this.size_};Bag.prototype.getCapacity=function(){return this.data_.length};Bag.prototype.isIndexWithinBounds=function(index){return index<this.getCapacity()};Bag.prototype.isEmpty=function(){return this.size_==0};Bag.prototype.add=function(e){if(this.size_===this.data_.length)this.grow();this.data_[this.size_++]=e};Bag.prototype.set=function(index,e){if(index>=this.data_.length)this.grow(index*2);this.size_=index+1;this.data_[index]=
e};Bag.prototype.grow=function(newCapacity){if(newCapacity===void 0)newCapacity=~~(this.data_.length*3/2)+1;this.data_.length=newCapacity};Bag.prototype.ensureCapacity=function(index){if(index>=this.data_.length)this.grow(index*2)};Bag.prototype.clear=function(){var i;for(i=0;i<this.size_;i++)this.data_[i]=null;this.size_=0};Bag.prototype.addAll=function(items){var i;for(i=0;items.size()>i;i++)this.add(items.get(i))};return Bag}();utils.Bag=Bag})(utils=artemis.utils||(artemis.utils={}))})(artemis||
(artemis={}));var artemis;
(function(artemis){var utils;(function(utils){var ADDRESS_BITS_PER_WORD=5;var BITS_PER_WORD=1<<ADDRESS_BITS_PER_WORD;var BIT_INDEX_MASK=BITS_PER_WORD-1;var WORD_MASK=4294967295;function numberOfTrailingZeros(i){if(i==0)return 64;var x=i;var y;var n=63;y=x<<32;if(y!=0){n-=32;x=y}y=x<<16;if(y!=0){n-=16;x=y}y=x<<8;if(y!=0){n-=8;x=y}y=x<<4;if(y!=0){n-=4;x=y}y=x<<2;if(y!=0){n-=2;x=y}return n-(x<<1>>>63)}var BitSet=function(){function BitSet(nbits){if(nbits===void 0)nbits=0;if(nbits<0)throw RangeError("Negative Array Size: ["+
nbits+"]");else if(nbits===0)this.words_=[];else{var words=this.words_=new Array((nbits-1>>ADDRESS_BITS_PER_WORD)+1);for(var i=0;i<words.length;i++)words[i]=0}}BitSet.prototype.nextSetBit=function(fromIndex){var u=fromIndex>>ADDRESS_BITS_PER_WORD;var words=this.words_;var wordsInUse=words.length;var word=words[u]&WORD_MASK<<fromIndex;while(true){if(word!=0)return u*BITS_PER_WORD+numberOfTrailingZeros(word);if(++u===wordsInUse)return-1;word=words[u]}};BitSet.prototype.intersects=function(set){var words=
this.words_;var wordsInUse=words.length;for(var i=Math.min(wordsInUse,set.words_.length)-1;i>=0;i--)if((words[i]&set.words_[i])!=0)return true;return false};BitSet.prototype.isEmpty=function(){return this.words_.length===0};BitSet.prototype.set=function(bitIndex,value){if(value===void 0)value=true;var wordIndex=bitIndex>>ADDRESS_BITS_PER_WORD;var words=this.words_;var wordsInUse=words.length;var wordsRequired=wordIndex+1;if(wordsInUse<wordsRequired){words.length=Math.max(2*wordsInUse,wordsRequired);
for(var i=wordsInUse;i<words.length;i++)words[i]=0}if(value)return words[wordIndex]|=1<<bitIndex;else return words[wordIndex]&=~(1<<bitIndex)};BitSet.prototype.get=function(bitIndex){var wordIndex=bitIndex>>ADDRESS_BITS_PER_WORD;var words=this.words_;var wordsInUse=words.length;return wordIndex<wordsInUse&&(words[wordIndex]&1<<bitIndex)!=0};BitSet.prototype.clear=function(bitIndex){if(bitIndex===null){var words=this.words_;var wordsInUse=words.length;while(wordsInUse>0)words[--wordsInUse]=0;return}var wordIndex=
bitIndex>>ADDRESS_BITS_PER_WORD;this.words_[wordIndex]&=~(1<<bitIndex)};return BitSet}();utils.BitSet=BitSet})(utils=artemis.utils||(artemis.utils={}))})(artemis||(artemis={}));var artemis;
(function(artemis){var utils;(function(utils){var MathUtils=function(){function MathUtils(){}MathUtils.nextBool=function(){return(~~(Math.random()*32767)&1)===1};MathUtils.nextDouble=function(){return Math.random()};MathUtils.nextInt=function(max){return~~(Math.random()*max)};MathUtils.random=function(start,end){if(end===null)return MathUtils.nextInt(start+1);else if(parseInt(start)===parseFloat(start)&&parseInt(end)===parseFloat(end))return start+MathUtils.nextInt(end-start+1);else return start+
MathUtils.nextDouble()*(end-start)};return MathUtils}();utils.MathUtils=MathUtils})(utils=artemis.utils||(artemis.utils={}))})(artemis||(artemis={}));var artemis;
(function(artemis){var utils;(function(utils){function decode(key){switch(typeof key){case "boolean":return""+key;case "number":return""+key;case "string":return key;case "function":return key.className||key.name;default:key.uuid=key.uuid?key.uuid:utils.UUID.randomUUID();return key.uuid}}var HashMap=function(){function HashMap(){this.clear()}HashMap.prototype.clear=function(){this.map_={};this.keys_={}};HashMap.prototype.values=function(){var result=[];for(var key in this.map_)result.push(this.map_[key]);
return result};HashMap.prototype.contains=function(value){for(var key in this.map_)if(value===this.map_[key])return true;return false};HashMap.prototype.containsKey=function(key){return decode(key)in this.map_};HashMap.prototype.containsValue=function(value){for(var key in this.map_)if(value===this.map_[key])return true;return false};HashMap.prototype.get=function(key){return this.map_[decode(key)]};HashMap.prototype.isEmpty=function(){return Object.keys(this.map_).length===0};HashMap.prototype.keys=
function(){var result=[];for(var key in this.keys_)result.push(this.keys_[key]);return result};HashMap.prototype.put=function(key,value){var k=decode(key);this.map_[k]=value;this.keys_[k]=key};HashMap.prototype.remove=function(key){var k=decode(key);delete this.map_[k];delete this.keys_[k]};HashMap.prototype.size=function(){return Object.keys(this.map_).length};return HashMap}();utils.HashMap=HashMap})(utils=artemis.utils||(artemis.utils={}))})(artemis||(artemis={}));
var Randum=function(){function Randum(){}Randum.prototype.nextBool=function(){return(~~(Math.random()*32767)&1)===1};Randum.prototype.nextDouble=function(){return Math.random()};Randum.prototype.nextInt=function(max){return~~(Math.random()*max)};return Randum}();var artemis;
(function(artemis){var utils;(function(utils){var Timer=function(){function Timer(delay,repeat){if(repeat===void 0)repeat=false;this.execute=function(){};this.delay=delay;this.repeat=repeat;this.acc=0}Timer.prototype.update=function(delta){if(!this.done&&!this.stopped){this.acc+=delta;if(this.acc>=this.delay){this.acc-=this.delay;if(this.repeat)this.reset();else this.done=true;this.execute()}}};Timer.prototype.reset=function(){this.stopped=false;this.done=false;this.acc=0};Timer.prototype.isDone=
function(){return this.done};Timer.prototype.isRunning=function(){return!this.done&&this.acc<this.delay&&!this.stopped};Timer.prototype.stop=function(){this.stopped=true};Timer.prototype.setDelay=function(delay){this.delay=delay};Timer.prototype.getPercentageRemaining=function(){if(this.done)return 100;else if(this.stopped)return 0;else return 1-(this.delay-this.acc)/this.delay};Timer.prototype.getDelay=function(){return this.delay};return Timer}();utils.Timer=Timer})(utils=artemis.utils||(artemis.utils=
{}))})(artemis||(artemis={}));var artemis;
(function(artemis){var utils;(function(utils){var lut=[];for(var i=0;i<256;i++)lut[i]=(i<16?"0":"")+i.toString(16);var UUID=function(){function UUID(){}UUID.randomUUID=function(){var d0=Math.random()*4294967295|0;var d1=Math.random()*4294967295|0;var d2=Math.random()*4294967295|0;var d3=Math.random()*4294967295|0;var uuid=lut[d0&255]+lut[d0>>8&255]+lut[d0>>16&255]+lut[d0>>24&255]+"-"+lut[d1&255]+lut[d1>>8&255]+"-"+lut[d1>>16&15|64]+lut[d1>>24&255]+"-"+lut[d2&63|128]+lut[d2>>8&255]+"-"+lut[d2>>16&
255]+lut[d2>>24&255]+lut[d3&255]+lut[d3>>8&255]+lut[d3>>16&255]+lut[d3>>24&255];if(uuid in UUID.check)throw new Error("Duplicate uuid ["+uuid+"]");UUID.check[uuid]=uuid;return uuid};UUID.check={};return UUID}();utils.UUID=UUID})(utils=artemis.utils||(artemis.utils={}))})(artemis||(artemis={}));var artemis;
(function(artemis){var annotations;(function(annotations){function Mapper(component){return function(target,propertyKey,descriptor){var klass=target.constructor;klass.declaredFields=klass.declaredFields||[];klass.declaredFields.push(propertyKey);klass.prototype[propertyKey]=component}}annotations.Mapper=Mapper})(annotations=artemis.annotations||(artemis.annotations={}))})(artemis||(artemis={}));var artemis;
(function(artemis){var Component=function(){function Component(){}return Component}();artemis.Component=Component})(artemis||(artemis={}));var artemis;
(function(artemis){var BitSet=artemis.utils.BitSet;var Aspect=function(){function Aspect(){this.allSet_=new BitSet;this.exclusionSet_=new BitSet;this.oneSet_=new BitSet}Aspect.prototype.getAllSet=function(){return this.allSet_};Aspect.prototype.getExclusionSet=function(){return this.exclusionSet_};Aspect.prototype.getOneSet=function(){return this.oneSet_};Aspect.prototype.all=function(type){var types=[];for(var _i=1;_i<arguments.length;_i++)types[_i-1]=arguments[_i];this.allSet_.set(artemis.ComponentType.getIndexFor(type));
var t;for(t in types)this.allSet_.set(artemis.ComponentType.getIndexFor(types[t]));return this};Aspect.prototype.exclude=function(type){var types=[];for(var _i=1;_i<arguments.length;_i++)types[_i-1]=arguments[_i];this.exclusionSet_.set(artemis.ComponentType.getIndexFor(type));var t;for(t in types)this.exclusionSet_.set(artemis.ComponentType.getIndexFor(types[t]));return this};Aspect.prototype.one=function(type){var types=[];for(var _i=1;_i<arguments.length;_i++)types[_i-1]=arguments[_i];this.oneSet_.set(artemis.ComponentType.getIndexFor(type));
for(var t in types)this.oneSet_.set(artemis.ComponentType.getIndexFor(types[t]));return this};Aspect.getAspectFor=function(type){var types=[];for(var _i=1;_i<arguments.length;_i++)types[_i-1]=arguments[_i];return Aspect.getAspectForAll.apply(Aspect,[type].concat(types))};Aspect.getAspectForAll=function(type){var types=[];for(var _i=1;_i<arguments.length;_i++)types[_i-1]=arguments[_i];var aspect=new Aspect;aspect.all.apply(aspect,[type].concat(types));return aspect};Aspect.getAspectForOne=function(type){var types=
[];for(var _i=1;_i<arguments.length;_i++)types[_i-1]=arguments[_i];var aspect=new Aspect;aspect.one.apply(aspect,[type].concat(types));return aspect};Aspect.getEmpty=function(){return new Aspect};return Aspect}();artemis.Aspect=Aspect})(artemis||(artemis={}));var artemis;
(function(artemis){var BitSet=artemis.utils.BitSet;var UUID=artemis.utils.UUID;var Entity=function(){function Entity(world,id){this.world_=world;this.id_=id;this.entityManager_=world.getEntityManager();this.componentManager_=world.getComponentManager();this.systemBits_=new BitSet;this.componentBits_=new BitSet;this.reset()}Entity.prototype.getId=function(){return this.id_};Entity.prototype.getComponentBits=function(){return this.componentBits_};Entity.prototype.getSystemBits=function(){return this.systemBits_};
Entity.prototype.reset=function(){this.systemBits_.clear();this.componentBits_.clear();this.uuid=UUID.randomUUID()};Entity.prototype.toString=function(){return"Entity["+this.id_+"]"};Entity.prototype.addComponent=function(component,type){if(type===void 0)type=artemis.ComponentType.getTypeFor(component.constructor);this.componentManager_.addComponent(this,type,component);return this};Entity.prototype.removeComponentInstance=function(component){this.removeComponent(artemis.ComponentType.getTypeFor(component.constructor));
return this};Entity.prototype.removeComponent=function(type){this.componentManager_.removeComponent(this,type);return this};Entity.prototype.removeComponentByType=function(type){this.removeComponent(artemis.ComponentType.getTypeFor(type));return this};Entity.prototype.isActive=function(){return this.entityManager_.isActive(this.id_)};Entity.prototype.isEnabled=function(){return this.entityManager_.isEnabled(this.id_)};Entity.prototype.getComponent=function(type){return this.componentManager_.getComponent(this,
type)};Entity.prototype.getComponentSlow=function(type){return this.componentManager_.getComponent(this,artemis.ComponentType.getTypeFor(type))};Entity.prototype.getComponents=function(fillBag){return this.componentManager_.getComponentsFor(this,fillBag)};Entity.prototype.addToWorld=function(){this.world_.addEntity(this)};Entity.prototype.changedInWorld=function(){this.world_.changedEntity(this)};Entity.prototype.deleteFromWorld=function(){this.world_.deleteEntity(this)};Entity.prototype.enable=function(){this.world_.enable(this)};
Entity.prototype.disable=function(){this.world_.disable(this)};Entity.prototype.getUuid=function(){return this.uuid};Entity.prototype.getWorld=function(){return this.world_};return Entity}();artemis.Entity=Entity})(artemis||(artemis={}));var artemis;
(function(artemis){var Manager=function(){function Manager(){}Manager.prototype.initialize=function(){};Manager.prototype.setWorld=function(world){this.world_=world};Manager.prototype.getWorld=function(){return this.world_};Manager.prototype.added=function(e){};Manager.prototype.changed=function(e){};Manager.prototype.deleted=function(e){};Manager.prototype.disabled=function(e){};Manager.prototype.enabled=function(e){};return Manager}();artemis.Manager=Manager})(artemis||(artemis={}));var artemis;
(function(artemis){var Bag=artemis.utils.Bag;var HashMap=artemis.utils.HashMap;var World=function(){function World(){this.managers_=new HashMap;this.managersBag_=new Bag;this.systems_=new HashMap;this.systemsBag_=new Bag;this.added_=new Bag;this.changed_=new Bag;this.deleted_=new Bag;this.enable_=new Bag;this.disable_=new Bag;this.cm_=new artemis.ComponentManager;this.setManager(this.cm_);this.em_=new artemis.EntityManager;this.setManager(this.em_)}World.prototype.initialize=function(){for(var i=
0;i<this.managersBag_.size();i++)this.managersBag_.get(i).initialize();for(var i=0;i<this.systemsBag_.size();i++){ComponentMapperInitHelper.config(this.systemsBag_.get(i),this);this.systemsBag_.get(i).initialize()}};World.prototype.getEntityManager=function(){return this.em_};World.prototype.getComponentManager=function(){return this.cm_};World.prototype.setManager=function(manager){this.managers_.put(manager.constructor,manager);this.managersBag_.add(manager);manager.setWorld(this);return manager};
World.prototype.getManager=function(managerType){return this.managers_.get(managerType)};World.prototype.deleteManager=function(manager){this.managers_.remove(manager);this.managersBag_.remove(manager)};World.prototype.getDelta=function(){return this.delta};World.prototype.setDelta=function(delta){this.delta=delta};World.prototype.addEntity=function(e){this.added_.add(e)};World.prototype.changedEntity=function(e){this.changed_.add(e)};World.prototype.deleteEntity=function(e){if(!this.deleted_.contains(e))this.deleted_.add(e)};
World.prototype.enable=function(e){this.enable_.add(e)};World.prototype.disable=function(e){this.disable_.add(e)};World.prototype.createEntity=function(){return this.em_.createEntityInstance()};World.prototype.getEntity=function(entityId){return this.em_.getEntity(entityId)};World.prototype.getSystems=function(){return this.systemsBag_};World.prototype.setSystem=function(system,passive){if(passive===void 0)passive=false;system.setWorld(this);system.setPassive(passive);this.systems_.put(system.constructor,
system);this.systemsBag_.add(system);return system};World.prototype.deleteSystem=function(system){this.systems_.remove(system.constructor);this.systemsBag_.remove(system)};World.prototype.notifySystems=function(performer,e){for(var i=0,s=this.systemsBag_.size();s>i;i++)performer.perform(this.systemsBag_.get(i),e)};World.prototype.notifyManagers=function(performer,e){for(var a=0;this.managersBag_.size()>a;a++)performer.perform(this.managersBag_.get(a),e)};World.prototype.getSystem=function(type){return this.systems_.get(type)};
World.prototype.check=function(entities,performer){if(!entities.isEmpty()){for(var i=0;entities.size()>i;i++){var e=entities.get(i);this.notifyManagers(performer,e);this.notifySystems(performer,e)}entities.clear()}};World.prototype.process=function(){this.check(this.added_,{perform:function(observer,e){observer.added(e)}});this.check(this.changed_,{perform:function(observer,e){observer.changed(e)}});this.check(this.disable_,{perform:function(observer,e){observer.disabled(e)}});this.check(this.enable_,
{perform:function(observer,e){observer.enabled(e)}});this.check(this.deleted_,{perform:function(observer,e){observer.deleted(e)}});this.cm_.clean();for(var i=0;this.systemsBag_.size()>i;i++){var system=this.systemsBag_.get(i);if(!system.isPassive())system.process()}};World.prototype.getMapper=function(type){return artemis.ComponentMapper.getFor(type,this)};return World}();artemis.World=World;var ComponentMapperInitHelper=function(){function ComponentMapperInitHelper(){}ComponentMapperInitHelper.config=
function(target,world){try{var clazz=target.constructor;var className=clazz.className||clazz.name;for(var fieldIndex in clazz.declaredFields){var field=clazz.declaredFields[fieldIndex];if(!target.hasOwnProperty(field)){var componentType=clazz.prototype[field];target[field]=world.getMapper(componentType)}}}catch(e){throw new Error("Error while setting component mappers");}};return ComponentMapperInitHelper}()})(artemis||(artemis={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var Bag=artemis.utils.Bag;var Manager=artemis.Manager;var ComponentManager=function(_super){__extends(ComponentManager,_super);function ComponentManager(){_super.call(this);this.componentsByType_=new Bag;this.deleted_=new Bag}ComponentManager.prototype.initialize=function(){};ComponentManager.prototype.removeComponentsOfEntity=function(e){var componentBits=e.getComponentBits();for(var i=componentBits.nextSetBit(0);i>=0;i=componentBits.nextSetBit(i+1))this.componentsByType_.get(i).set(e.getId(),
null);componentBits.clear()};ComponentManager.prototype.addComponent=function(e,type,component){this.componentsByType_.ensureCapacity(type.getIndex());var components=this.componentsByType_.get(type.getIndex());if(components==null){components=new Bag;this.componentsByType_.set(type.getIndex(),components)}components.set(e.getId(),component);e.getComponentBits().set(type.getIndex())};ComponentManager.prototype.removeComponent=function(e,type){if(e.getComponentBits().get(type.getIndex())){this.componentsByType_.get(type.getIndex()).set(e.getId(),
null);e.getComponentBits().clear(type.getIndex())}};ComponentManager.prototype.getComponentsByType=function(type){var components=this.componentsByType_.get(type.getIndex());if(components==null){components=new Bag;this.componentsByType_.set(type.getIndex(),components)}return components};ComponentManager.prototype.getComponent=function(e,type){var components=this.componentsByType_.get(type.getIndex());if(components!=null)return components.get(e.getId());return null};ComponentManager.prototype.getComponentsFor=
function(e,fillBag){var componentBits=e.getComponentBits();for(var i=componentBits.nextSetBit(0);i>=0;i=componentBits.nextSetBit(i+1))fillBag.add(this.componentsByType_.get(i).get(e.getId()));return fillBag};ComponentManager.prototype.deleted=function(e){this.deleted_.add(e)};ComponentManager.prototype.clean=function(){if(this.deleted_.size()>0){for(var i=0;this.deleted_.size()>i;i++)this.removeComponentsOfEntity(this.deleted_.get(i));this.deleted_.clear()}};return ComponentManager}(Manager);artemis.ComponentManager=
ComponentManager})(artemis||(artemis={}));var artemis;
(function(artemis){var HashMap=artemis.utils.HashMap;var ComponentType=function(){function ComponentType(type){this.index_=ComponentType.INDEX++;this.type_=type}ComponentType.prototype.getIndex=function(){return this.index_};ComponentType.prototype.toString=function(){var klass=ComponentType;return"ComponentType["+klass.name+"] ("+this.index_+")"};ComponentType.getTypeFor=function(c){var type=ComponentType.componentTypes.get(c);if(type==null){type=new ComponentType(c);ComponentType.componentTypes.put(c,
type)}return type};ComponentType.getIndexFor=function(c){return ComponentType.getTypeFor(c).getIndex()};ComponentType.INDEX=0;ComponentType.componentTypes=new HashMap;return ComponentType}();artemis.ComponentType=ComponentType})(artemis||(artemis={}));var artemis;
(function(artemis){var ComponentType=artemis.ComponentType;var ComponentMapper=function(){function ComponentMapper(type,world){this.type_=ComponentType.getTypeFor(type);this.components_=world.getComponentManager().getComponentsByType(this.type_);this.classType_=type}ComponentMapper.prototype.get=function(e){return this.components_.get(e.getId())};ComponentMapper.prototype.getSafe=function(e){if(this.components_.isIndexWithinBounds(e.getId()))return this.components_.get(e.getId());return null};ComponentMapper.prototype.has=
function(e){return this.getSafe(e)!=null};ComponentMapper.getFor=function(type,world){return new ComponentMapper(type,world)};return ComponentMapper}();artemis.ComponentMapper=ComponentMapper})(artemis||(artemis={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var Bag=artemis.utils.Bag;var BitSet=artemis.utils.BitSet;var Manager=artemis.Manager;var EntityManager=function(_super){__extends(EntityManager,_super);function EntityManager(){_super.call(this);this.entities_=new Bag;this.disabled_=new BitSet;this.identifierPool_=new IdentifierPool}EntityManager.prototype.initialize=function(){};EntityManager.prototype.createEntityInstance=function(){var e=new artemis.Entity(this.world_,this.identifierPool_.checkOut());this.created_++;return e};
EntityManager.prototype.added=function(e){this.active_++;this.added_++;this.entities_.set(e.getId(),e)};EntityManager.prototype.enabled=function(e){this.disabled_.clear(e.getId())};EntityManager.prototype.disabled=function(e){this.disabled_.set(e.getId())};EntityManager.prototype.deleted=function(e){this.entities_.set(e.getId(),null);this.disabled_.clear(e.getId());this.identifierPool_.checkIn(e.getId());this.active_--;this.deleted_++};EntityManager.prototype.isActive=function(entityId){return this.entities_.get(entityId)!=
null};EntityManager.prototype.isEnabled=function(entityId){return!this.disabled_.get(entityId)};EntityManager.prototype.getEntity=function(entityId){return this.entities_.get(entityId)};EntityManager.prototype.getActiveEntityCount=function(){return this.active_};EntityManager.prototype.getTotalCreated=function(){return this.created_};EntityManager.prototype.getTotalAdded=function(){return this.added_};EntityManager.prototype.getTotalDeleted=function(){return this.deleted_};return EntityManager}(Manager);
artemis.EntityManager=EntityManager;var IdentifierPool=function(){function IdentifierPool(){this.nextAvailableId_=0;this.ids_=new Bag}IdentifierPool.prototype.checkOut=function(){if(this.ids_.size()>0)return this.ids_.removeLast();return this.nextAvailableId_++};IdentifierPool.prototype.checkIn=function(id){this.ids_.add(id)};return IdentifierPool}()})(artemis||(artemis={}));var artemis;
(function(artemis){var Bag=artemis.utils.Bag;var HashMap=artemis.utils.HashMap;var EntitySystem=function(){function EntitySystem(aspect){this.actives_=new Bag;this.aspect_=aspect;this.allSet_=aspect.getAllSet();this.exclusionSet_=aspect.getExclusionSet();this.oneSet_=aspect.getOneSet();this.systemIndex_=SystemIndexManager.getIndexFor(this.constructor);this.dummy_=this.allSet_.isEmpty()&&this.oneSet_.isEmpty()}EntitySystem.prototype.begin=function(){};EntitySystem.prototype.process=function(){if(this.checkProcessing()){this.begin();
this.processEntities(this.actives_);this.end()}};EntitySystem.prototype.end=function(){};EntitySystem.prototype.processEntities=function(entities){};EntitySystem.prototype.checkProcessing=function(){return true};EntitySystem.prototype.initialize=function(){};EntitySystem.prototype.inserted=function(e){};EntitySystem.prototype.removed=function(e){};EntitySystem.prototype.check=function(e){if(this.dummy_)return;var contains=e.getSystemBits().get(this.systemIndex_);var interested=true;var componentBits=
e.getComponentBits();if(!this.allSet_.isEmpty())for(var i=this.allSet_.nextSetBit(0);i>=0;i=this.allSet_.nextSetBit(i+1))if(!componentBits.get(i)){interested=false;break}if(!this.exclusionSet_.isEmpty()&&interested)interested=!this.exclusionSet_.intersects(componentBits);if(!this.oneSet_.isEmpty())interested=this.oneSet_.intersects(componentBits);if(interested&&!contains)this.insertToSystem(e);else if(!interested&&contains)this.removeFromSystem(e)};EntitySystem.prototype.removeFromSystem=function(e){this.actives_.remove(e);
e.getSystemBits().clear(this.systemIndex_);this.removed(e)};EntitySystem.prototype.insertToSystem=function(e){this.actives_.add(e);e.getSystemBits().set(this.systemIndex_);this.inserted(e)};EntitySystem.prototype.added=function(e){this.check(e)};EntitySystem.prototype.changed=function(e){this.check(e)};EntitySystem.prototype.deleted=function(e){if(e.getSystemBits().get(this.systemIndex_))this.removeFromSystem(e)};EntitySystem.prototype.disabled=function(e){if(e.getSystemBits().get(this.systemIndex_))this.removeFromSystem(e)};
EntitySystem.prototype.enabled=function(e){this.check(e)};EntitySystem.prototype.setWorld=function(world){this.world=world};EntitySystem.prototype.isPassive=function(){return this.passive_};EntitySystem.prototype.setPassive=function(passive){this.passive_=passive};EntitySystem.prototype.getActives=function(){return this.actives_};return EntitySystem}();artemis.EntitySystem=EntitySystem;var SystemIndexManager=function(){function SystemIndexManager(){}SystemIndexManager.getIndexFor=function(es){var index=
SystemIndexManager.indices.get(es);if(index===undefined){index=SystemIndexManager.INDEX++;SystemIndexManager.indices.put(es,index)}return index};SystemIndexManager.INDEX=0;SystemIndexManager.indices=new HashMap;return SystemIndexManager}()})(artemis||(artemis={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var Bag=artemis.utils.Bag;var HashMap=artemis.utils.HashMap;var Manager=artemis.Manager;var managers;(function(managers){var GroupManager=function(_super){__extends(GroupManager,_super);function GroupManager(){_super.call(this);this.entitiesByGroup_=new HashMap;this.groupsByEntity_=new HashMap}GroupManager.prototype.initialize=function(){};GroupManager.prototype.add=function(e,group){var entities=this.entitiesByGroup_.get(group);if(entities==null){entities=new Bag;this.entitiesByGroup_.put(group,
entities)}entities.add(e);var groups=this.groupsByEntity_.get(e);if(groups==null){groups=new Bag;this.groupsByEntity_.put(e,groups)}groups.add(group)};GroupManager.prototype.remove=function(e,group){var entities=this.entitiesByGroup_.get(group);if(entities!=null)entities.remove(e);var groups=this.groupsByEntity_.get(e);if(groups!=null)groups.remove(group)};GroupManager.prototype.removeFromAllGroups=function(e){var groups=this.groupsByEntity_.get(e);if(groups!=null){for(var i=0;groups.size()>i;i++){var entities=
this.entitiesByGroup_.get(groups.get(i));if(entities!=null)entities.remove(e)}groups.clear()}};GroupManager.prototype.getEntities=function(group){var entities=this.entitiesByGroup_.get(group);if(entities==null){entities=new Bag;this.entitiesByGroup_.put(group,entities)}return entities};GroupManager.prototype.getGroups=function(e){return this.groupsByEntity_.get(e)};GroupManager.prototype.isInAnyGroup=function(e){return this.getGroups(e)!=null};GroupManager.prototype.isInGroup=function(e,group){if(group!=
null){var groups=this.groupsByEntity_.get(e);for(var i=0;groups.size()>i;i++){var g=groups.get(i);if(group===g)return true}}return false};GroupManager.prototype.deleted=function(e){this.removeFromAllGroups(e)};return GroupManager}(Manager);managers.GroupManager=GroupManager})(managers=artemis.managers||(artemis.managers={}))})(artemis||(artemis={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var Bag=artemis.utils.Bag;var HashMap=artemis.utils.HashMap;var Manager=artemis.Manager;var managers;(function(managers){var PlayerManager=function(_super){__extends(PlayerManager,_super);function PlayerManager(){_super.call(this);this.playerByEntity_=new HashMap;this.entitiesByPlayer_=new HashMap}PlayerManager.prototype.setPlayer=function(e,player){this.playerByEntity_.put(e,player);var entities=this.entitiesByPlayer_.get(player);if(entities==null){entities=new Bag;this.entitiesByPlayer_.put(player,
entities)}entities.add(e)};PlayerManager.prototype.getEntitiesOfPlayer=function(player){var entities=this.entitiesByPlayer_.get(player);if(entities==null)entities=new Bag;return entities};PlayerManager.prototype.removeFromPlayer=function(e){var player=this.playerByEntity_.get(e);if(player!==null){var entities=this.entitiesByPlayer_.get(player);if(entities!==null)entities.remove(e)}};PlayerManager.prototype.getPlayer=function(e){return this.playerByEntity_.get(e)};PlayerManager.prototype.initialize=
function(){};PlayerManager.prototype.deleted=function(e){this.removeFromPlayer(e)};return PlayerManager}(Manager);managers.PlayerManager=PlayerManager})(managers=artemis.managers||(artemis.managers={}))})(artemis||(artemis={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var managers;(function(managers){var HashMap=artemis.utils.HashMap;var Manager=artemis.Manager;var TagManager=function(_super){__extends(TagManager,_super);function TagManager(){_super.call(this);this.entitiesByTag_=new HashMap;this.tagsByEntity_=new HashMap}TagManager.prototype.register=function(tag,e){this.entitiesByTag_.put(tag,e);this.tagsByEntity_.put(e,tag)};TagManager.prototype.unregister=function(tag){this.tagsByEntity_.remove(this.entitiesByTag_.remove(tag))};TagManager.prototype.isRegistered=
function(tag){return this.entitiesByTag_.containsKey(tag)};TagManager.prototype.getEntity=function(tag){return this.entitiesByTag_.get(tag)};TagManager.prototype.getRegisteredTags=function(){return this.tagsByEntity_.values()};TagManager.prototype.deleted=function(e){var removedTag=this.tagsByEntity_.remove(e);if(removedTag!=null)this.entitiesByTag_.remove(removedTag)};TagManager.prototype.initialize=function(){};return TagManager}(Manager);managers.TagManager=TagManager})(managers=artemis.managers||
(artemis.managers={}))})(artemis||(artemis={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var Bag=artemis.utils.Bag;var HashMap=artemis.utils.HashMap;var Manager=artemis.Manager;var managers;(function(managers){var TeamManager=function(_super){__extends(TeamManager,_super);function TeamManager(){_super.call(this);this.playersByTeam_=new HashMap;this.teamByPlayer_=new HashMap}TeamManager.prototype.initialize=function(){};TeamManager.prototype.getTeam=function(player){return this.teamByPlayer_.get(player)};TeamManager.prototype.setTeam=function(player,team){this.removeFromTeam(player);
this.teamByPlayer_.put(player,team);var players=this.playersByTeam_.get(team);if(players==null){players=new Bag;this.playersByTeam_.put(team,players)}players.add(player)};TeamManager.prototype.getPlayers=function(team){return this.playersByTeam_.get(team)};TeamManager.prototype.removeFromTeam=function(player){var team=this.teamByPlayer_.remove(player);if(team!=null){var players=this.playersByTeam_.get(team);if(players!=null)players.remove(player)}};return TeamManager}(Manager);managers.TeamManager=
TeamManager})(managers=artemis.managers||(artemis.managers={}))})(artemis||(artemis={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var systems;(function(systems){var EntitySystem=artemis.EntitySystem;var DelayedEntityProcessingSystem=function(_super){__extends(DelayedEntityProcessingSystem,_super);function DelayedEntityProcessingSystem(aspect){_super.call(this,aspect)}DelayedEntityProcessingSystem.prototype.processEntities=function(entities){for(var i=0,s=entities.size();s>i;i++){var entity=entities.get(i);this.processDelta(entity,this.acc_);var remaining=this.getRemainingDelay(entity);if(remaining<=0)this.processExpired(entity);
else this.offerDelay(remaining)}this.stop()};DelayedEntityProcessingSystem.prototype.inserted=function(e){var delay=this.getRemainingDelay(e);if(delay>0)this.offerDelay(delay)};DelayedEntityProcessingSystem.prototype.getRemainingDelay=function(e){throw Error("Abstract Method");};DelayedEntityProcessingSystem.prototype.checkProcessing=function(){if(this.running_){this.acc_+=this.world.getDelta();if(this.acc_>=this.delay_)return true}return false};DelayedEntityProcessingSystem.prototype.processDelta=
function(e,accumulatedDelta){};DelayedEntityProcessingSystem.prototype.processExpired=function(e){};DelayedEntityProcessingSystem.prototype.restart=function(delay){this.delay_=delay;this.acc_=0;this.running_=true};DelayedEntityProcessingSystem.prototype.offerDelay=function(delay){if(!this.running_||delay<this.getRemainingTimeUntilProcessing())this.restart(delay)};DelayedEntityProcessingSystem.prototype.getInitialTimeDelay=function(){return this.delay_};DelayedEntityProcessingSystem.prototype.getRemainingTimeUntilProcessing=
function(){if(this.running_)return this.delay_-this.acc_;return 0};DelayedEntityProcessingSystem.prototype.isRunning=function(){return this.running_};DelayedEntityProcessingSystem.prototype.stop=function(){this.running_=false;this.acc_=0};return DelayedEntityProcessingSystem}(EntitySystem);systems.DelayedEntityProcessingSystem=DelayedEntityProcessingSystem})(systems=artemis.systems||(artemis.systems={}))})(artemis||(artemis={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var systems;(function(systems){var EntitySystem=artemis.EntitySystem;var EntityProcessingSystem=function(_super){__extends(EntityProcessingSystem,_super);function EntityProcessingSystem(aspect){_super.call(this,aspect)}EntityProcessingSystem.prototype.processEach=function(e){};EntityProcessingSystem.prototype.processEntities=function(entities){for(var i=0,s=entities.size();s>i;i++)this.processEach(entities.get(i))};EntityProcessingSystem.prototype.checkProcessing=function(){return true};
return EntityProcessingSystem}(EntitySystem);systems.EntityProcessingSystem=EntityProcessingSystem})(systems=artemis.systems||(artemis.systems={}))})(artemis||(artemis={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var systems;(function(systems){var EntitySystem=artemis.EntitySystem;var IntervalEntitySystem=function(_super){__extends(IntervalEntitySystem,_super);function IntervalEntitySystem(aspect,interval){_super.call(this,aspect);this.interval_=interval}IntervalEntitySystem.prototype.checkProcessing=function(){this.acc_+=this.world.getDelta();if(this.acc_>=this.interval_){this.acc_-=this.interval_;return true}return false};return IntervalEntitySystem}(EntitySystem);systems.IntervalEntitySystem=
IntervalEntitySystem})(systems=artemis.systems||(artemis.systems={}))})(artemis||(artemis={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var systems;(function(systems){var EntitySystem=artemis.EntitySystem;var Aspect=artemis.Aspect;var VoidEntitySystem=function(_super){__extends(VoidEntitySystem,_super);function VoidEntitySystem(){_super.call(this,Aspect.getEmpty())}VoidEntitySystem.prototype.processEntities=function(entities){this.processSystem()};VoidEntitySystem.prototype.processSystem=function(){};VoidEntitySystem.prototype.checkProcessing=function(){return true};return VoidEntitySystem}(EntitySystem);systems.VoidEntitySystem=
VoidEntitySystem})(systems=artemis.systems||(artemis.systems={}))})(artemis||(artemis={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var artemis;
(function(artemis){var systems;(function(systems){var IntervalEntitySystem=artemis.systems.IntervalEntitySystem;var IntervalEntityProcessingSystem=function(_super){__extends(IntervalEntityProcessingSystem,_super);function IntervalEntityProcessingSystem(aspect,interval){_super.call(this,aspect,interval)}IntervalEntityProcessingSystem.prototype.processEach=function(e){};IntervalEntityProcessingSystem.prototype.processEntities=function(entities){for(var i=0,s=entities.size();s>i;i++)this.processEach(entities.get(i))};
return IntervalEntityProcessingSystem}(IntervalEntitySystem);systems.IntervalEntityProcessingSystem=IntervalEntityProcessingSystem})(systems=artemis.systems||(artemis.systems={}))})(artemis||(artemis={}));(function(root,factory){if("function"===typeof define&&undefined.amd)define(factory);else if("object"==typeof exports)module.exports=factory();else root["artemis"]=factory()})(this,function(){return artemis});var brokenspork;
(function(brokenspork){var core;(function(core){var Constants=function(){function Constants(){}Constants.FRAME_WIDTH=1280;Constants.FRAME_HEIGHT=720;Constants.Groups={PLAYER_BULLETS:"player bullets",PLAYER_SHIP:"player ship",ENEMY_SHIPS:"enemy ships",ENEMY_BULLETS:"enemy bullets"};return Constants}();core.Constants=Constants})(core=brokenspork.core||(brokenspork.core={}))})(brokenspork||(brokenspork={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var brokenspork;
(function(brokenspork){var components;(function(components){var Component=artemis.Component;var Bounds=function(_super){__extends(Bounds,_super);function Bounds(){_super.apply(this,arguments)}Bounds.className="Bounds";return Bounds}(Component);components.Bounds=Bounds;Bounds.prototype.radius=0})(components=brokenspork.components||(brokenspork.components={}))})(brokenspork||(brokenspork={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var brokenspork;
(function(brokenspork){var components;(function(components){var Component=artemis.Component;var ColorAnimation=function(_super){__extends(ColorAnimation,_super);function ColorAnimation(){_super.apply(this,arguments)}ColorAnimation.className="ColorAnimation";return ColorAnimation}(Component);components.ColorAnimation=ColorAnimation;ColorAnimation.prototype.redMin=0;ColorAnimation.prototype.redMax=0;ColorAnimation.prototype.redSpeed=0;ColorAnimation.prototype.redAnimate=false;ColorAnimation.prototype.greenMin=
0;ColorAnimation.prototype.greenMax=0;ColorAnimation.prototype.greenSpeed=0;ColorAnimation.prototype.greenAnimate=false;ColorAnimation.prototype.blueMin=0;ColorAnimation.prototype.blueMax=0;ColorAnimation.prototype.blueSpeed=0;ColorAnimation.prototype.blueAnimate=false;ColorAnimation.prototype.alphaMin=0;ColorAnimation.prototype.alphaMax=0;ColorAnimation.prototype.alphaSpeed=0;ColorAnimation.prototype.alphaAnimate=false;ColorAnimation.prototype.repeat=false})(components=brokenspork.components||(brokenspork.components=
{}))})(brokenspork||(brokenspork={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var brokenspork;
(function(brokenspork){var components;(function(components){var Component=artemis.Component;var Enemy=function(_super){__extends(Enemy,_super);function Enemy(){_super.apply(this,arguments)}Enemy.className="Enemy";return Enemy}(Component);components.Enemy=Enemy})(components=brokenspork.components||(brokenspork.components={}))})(brokenspork||(brokenspork={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var brokenspork;
(function(brokenspork){var components;(function(components){var Component=artemis.Component;var Expires=function(_super){__extends(Expires,_super);function Expires(){_super.apply(this,arguments)}Expires.className="Expires";return Expires}(Component);components.Expires=Expires;Expires.prototype.delay=0})(components=brokenspork.components||(brokenspork.components={}))})(brokenspork||(brokenspork={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var brokenspork;
(function(brokenspork){var components;(function(components){var Component=artemis.Component;var Health=function(_super){__extends(Health,_super);function Health(){_super.apply(this,arguments)}Health.className="Health";return Health}(Component);components.Health=Health;Health.prototype.health=0;Health.prototype.maximumHealth=0})(components=brokenspork.components||(brokenspork.components={}))})(brokenspork||(brokenspork={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var brokenspork;
(function(brokenspork){var components;(function(components){var Component=artemis.Component;var ParallaxStar=function(_super){__extends(ParallaxStar,_super);function ParallaxStar(){_super.apply(this,arguments)}ParallaxStar.className="ParallaxStar";return ParallaxStar}(Component);components.ParallaxStar=ParallaxStar})(components=brokenspork.components||(brokenspork.components={}))})(brokenspork||(brokenspork={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var brokenspork;
(function(brokenspork){var components;(function(components){var Component=artemis.Component;var Player=function(_super){__extends(Player,_super);function Player(){_super.apply(this,arguments)}Player.className="Player";return Player}(Component);components.Player=Player})(components=brokenspork.components||(brokenspork.components={}))})(brokenspork||(brokenspork={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var brokenspork;
(function(brokenspork){var components;(function(components){var Component=artemis.Component;var Position=function(_super){__extends(Position,_super);function Position(){_super.apply(this,arguments)}Position.className="Position";return Position}(Component);components.Position=Position;Position.prototype.x=0;Position.prototype.y=0})(components=brokenspork.components||(brokenspork.components={}))})(brokenspork||(brokenspork={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var brokenspork;
(function(brokenspork){var components;(function(components){var Component=artemis.Component;var ScaleAnimation=function(_super){__extends(ScaleAnimation,_super);function ScaleAnimation(){_super.apply(this,arguments)}ScaleAnimation.className="ScaleAnimation";return ScaleAnimation}(Component);components.ScaleAnimation=ScaleAnimation;ScaleAnimation.prototype.min=0;ScaleAnimation.prototype.max=0;ScaleAnimation.prototype.speed=0;ScaleAnimation.prototype.repeat=false;ScaleAnimation.prototype.active=false})(components=
brokenspork.components||(brokenspork.components={}))})(brokenspork||(brokenspork={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var brokenspork;
(function(brokenspork){var components;(function(components){var Component=artemis.Component;(function(EFFECT){EFFECT[EFFECT["PEW"]=0]="PEW";EFFECT[EFFECT["ASPLODE"]=1]="ASPLODE";EFFECT[EFFECT["SMALLASPLODE"]=2]="SMALLASPLODE"})(components.EFFECT||(components.EFFECT={}));var EFFECT=components.EFFECT;var SoundEffect=function(_super){__extends(SoundEffect,_super);function SoundEffect(){_super.apply(this,arguments)}SoundEffect.className="SoundEffect";return SoundEffect}(Component);components.SoundEffect=
SoundEffect;SoundEffect.prototype.effect=EFFECT.PEW})(components=brokenspork.components||(brokenspork.components={}))})(brokenspork||(brokenspork={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var brokenspork;
(function(brokenspork){var components;(function(components){var Component=artemis.Component;(function(Layer){Layer[Layer["DEFAULT"]=0]="DEFAULT";Layer[Layer["BACKGROUND"]=1]="BACKGROUND";Layer[Layer["ACTORS_1"]=2]="ACTORS_1";Layer[Layer["ACTORS_2"]=3]="ACTORS_2";Layer[Layer["ACTORS_3"]=4]="ACTORS_3";Layer[Layer["PARTICLES"]=5]="PARTICLES"})(components.Layer||(components.Layer={}));var Layer=components.Layer;var Sprite=function(_super){__extends(Sprite,_super);function Sprite(){_super.call(this);this.sprite_=
new cc.Sprite}Object.defineProperty(Sprite.prototype,"name",{get:function(){return this.name_},set:function(value){this.name_=value;this.sprite_.initWithSpriteFrameName(value+".png")},enumerable:true,configurable:true});Object.defineProperty(Sprite.prototype,"scaleX",{get:function(){return this.sprite_.getScaleX()},set:function(value){this.sprite_.setScaleX(value)},enumerable:true,configurable:true});Object.defineProperty(Sprite.prototype,"scaleY",{get:function(){return this.sprite_.getScaleY()},
set:function(value){this.sprite_.setScaleY(value)},enumerable:true,configurable:true});Object.defineProperty(Sprite.prototype,"rotation",{get:function(){return this.sprite_.getRotation()},set:function(value){this.sprite_.setRotation(value)},enumerable:true,configurable:true});Object.defineProperty(Sprite.prototype,"r",{get:function(){return this.r_},set:function(value){this.r_=value;this.sprite_.setColor(cc.color(this.r_,this.g_,this.b_))},enumerable:true,configurable:true});Object.defineProperty(Sprite.prototype,
"g",{get:function(){return this.g_},set:function(value){this.g_=value;this.sprite_.setColor(cc.color(this.r_,this.g_,this.b_))},enumerable:true,configurable:true});Object.defineProperty(Sprite.prototype,"b",{get:function(){return this.b_},set:function(value){this.b_=value;this.sprite_.setColor(cc.color(this.r_,this.g_,this.b_))},enumerable:true,configurable:true});Object.defineProperty(Sprite.prototype,"a",{get:function(){return this.a_},set:function(value){this.a_=value;this.sprite_.setColor(cc.color(this.r_,
this.g_,this.b_,this.a_))},enumerable:true,configurable:true});Sprite.className="Sprite";return Sprite}(Component);components.Sprite=Sprite;Sprite.prototype.layer=Layer.DEFAULT;Sprite.prototype.name_="";Sprite.prototype.scaleX_=1;Sprite.prototype.scaleY_=1;Sprite.prototype.rotation_=0;Sprite.prototype.r_=255;Sprite.prototype.g_=255;Sprite.prototype.b_=255;Sprite.prototype.a_=255;Sprite.prototype.sprite_=null})(components=brokenspork.components||(brokenspork.components={}))})(brokenspork||(brokenspork=
{}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var brokenspork;
(function(brokenspork){var components;(function(components){var Component=artemis.Component;var Velocity=function(_super){__extends(Velocity,_super);function Velocity(){_super.apply(this,arguments)}Velocity.className="Velocity";return Velocity}(Component);components.Velocity=Velocity;Velocity.prototype.vectorX=0;Velocity.prototype.vectorY=0})(components=brokenspork.components||(brokenspork.components={}))})(brokenspork||(brokenspork={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var brokenspork;
(function(brokenspork){var systems;(function(systems){var Bag=artemis.utils.Bag;var Bounds=brokenspork.components.Bounds;var Expires=brokenspork.components.Expires;var Health=brokenspork.components.Health;var Position=brokenspork.components.Position;var Constants=brokenspork.core.Constants;var EntityFactory=brokenspork.core.EntityFactory;var Mapper=artemis.annotations.Mapper;var EntitySystem=artemis.EntitySystem;var Aspect=artemis.Aspect;var GroupManager=artemis.managers.GroupManager;var CollisionSystem=
function(_super){__extends(CollisionSystem,_super);function CollisionSystem(game){_super.call(this,Aspect.getAspectForAll(Position,Bounds));this.game=game}CollisionSystem.prototype.initialize=function(){var self=this;this.collisionPairs=new Bag;this.collisionPairs.add(new CollisionPair(this,Constants.Groups.PLAYER_BULLETS,Constants.Groups.ENEMY_SHIPS,{handleCollision:function(bullet,ship){var bp=self.pm.get(bullet);EntityFactory.createSmallExplosion(self.game,self.world,bp.x,bp.y).addToWorld();for(var i=
0;4>i;i++)EntityFactory.createParticle(self.game,self.world,bp.x,bp.y).addToWorld();bullet.deleteFromWorld();var health=self.hm.get(ship);var position=self.pm.get(ship);health.health-=1;if(health.health<0){health.health=0;ship.deleteFromWorld();EntityFactory.createBigExplosion(self.game,self.world,position.x,position.y).addToWorld()}}}))};CollisionSystem.prototype.processEntities=function(entities){for(var i=0;this.collisionPairs.size()>i;i++)this.collisionPairs.get(i).checkForCollisions()};CollisionSystem.prototype.checkProcessing=
function(){return true};__decorate([Mapper(Position)],CollisionSystem.prototype,"pm");__decorate([Mapper(Bounds)],CollisionSystem.prototype,"bm");__decorate([Mapper(Health)],CollisionSystem.prototype,"hm");__decorate([Mapper(Expires)],CollisionSystem.prototype,"ex");return CollisionSystem}(EntitySystem);systems.CollisionSystem=CollisionSystem;var CollisionPair=function(){function CollisionPair(cs,group1,group2,handler){this.groupEntitiesA=cs.world.getManager(GroupManager).getEntities(group1);this.groupEntitiesB=
cs.world.getManager(GroupManager).getEntities(group2);this.handler=handler;this.cs=cs}CollisionPair.prototype.checkForCollisions=function(){for(var a=0;this.groupEntitiesA.size()>a;a++)for(var b=0;this.groupEntitiesB.size()>b;b++){var entityA=this.groupEntitiesA.get(a);var entityB=this.groupEntitiesB.get(b);if(this.collisionExists(entityA,entityB))this.handler.handleCollision(entityA,entityB)}};CollisionPair.prototype.collisionExists=function(e1,e2){if(e1==null||e2==null)return false;var p1=this.cs.pm.get(e1);
var p2=this.cs.pm.get(e2);var b1=this.cs.bm.get(e1);var b2=this.cs.bm.get(e2);return false};return CollisionPair}()})(systems=brokenspork.systems||(brokenspork.systems={}))})(brokenspork||(brokenspork={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var brokenspork;
(function(brokenspork){var systems;(function(systems){var ColorAnimation=brokenspork.components.ColorAnimation;var Sprite=brokenspork.components.Sprite;var Mapper=artemis.annotations.Mapper;var EntityProcessingSystem=artemis.systems.EntityProcessingSystem;var Aspect=artemis.Aspect;var ColorAnimationSystem=function(_super){__extends(ColorAnimationSystem,_super);function ColorAnimationSystem(){_super.call(this,Aspect.getAspectForAll(ColorAnimation,Sprite))}ColorAnimationSystem.prototype.processEach=
function(e){var c=this.cam.get(e);var sprite=this.sm.get(e);if(c.alphaAnimate){sprite.a+=c.alphaSpeed*this.world.delta;if(sprite.a>c.alphaMax||sprite.a<c.alphaMin)if(c.repeat)c.alphaSpeed=-c.alphaSpeed;else c.alphaAnimate=false}};__decorate([Mapper(ColorAnimation)],ColorAnimationSystem.prototype,"cam");__decorate([Mapper(Sprite)],ColorAnimationSystem.prototype,"sm");return ColorAnimationSystem}(EntityProcessingSystem);systems.ColorAnimationSystem=ColorAnimationSystem})(systems=brokenspork.systems||
(brokenspork.systems={}))})(brokenspork||(brokenspork={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var brokenspork;
(function(brokenspork){var systems;(function(systems){var MathUtils=artemis.utils.MathUtils;var Layer=brokenspork.components.Layer;var Constants=brokenspork.core.Constants;var EntityFactory=brokenspork.core.EntityFactory;var VoidEntitySystem=artemis.systems.VoidEntitySystem;var Timer=artemis.utils.Timer;var EntitySpawningTimerSystem=function(_super){__extends(EntitySpawningTimerSystem,_super);function EntitySpawningTimerSystem(game){var _this=this;_super.call(this);this.timer1=new Timer(2,true);this.timer1.execute=
function(){EntityFactory.createEnemyShip(_this.game,_this.world,"enemy1",Layer.ACTORS_3,10,MathUtils.random(-Constants.FRAME_WIDTH/2,Constants.FRAME_WIDTH/2),Constants.FRAME_HEIGHT/2+50,0,-40,20).addToWorld()};this.timer2=new Timer(6,true);this.timer2.execute=function(){EntityFactory.createEnemyShip(_this.game,_this.world,"enemy2",Layer.ACTORS_2,20,MathUtils.random(-Constants.FRAME_WIDTH/2,Constants.FRAME_WIDTH/2),Constants.FRAME_HEIGHT/2+100,0,-30,40).addToWorld()};this.timer3=new Timer(12,true);
this.timer3.execute=function(){EntityFactory.createEnemyShip(_this.game,_this.world,"enemy3",Layer.ACTORS_1,60,MathUtils.random(-Constants.FRAME_WIDTH/2,Constants.FRAME_WIDTH/2),Constants.FRAME_HEIGHT/2+200,0,-20,70).addToWorld()}}EntitySpawningTimerSystem.prototype.processSystem=function(){this.timer1.update(this.world.delta);this.timer2.update(this.world.delta);this.timer3.update(this.world.delta)};return EntitySpawningTimerSystem}(VoidEntitySystem);systems.EntitySpawningTimerSystem=EntitySpawningTimerSystem})(systems=
brokenspork.systems||(brokenspork.systems={}))})(brokenspork||(brokenspork={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var brokenspork;
(function(brokenspork){var systems;(function(systems){var Expires=brokenspork.components.Expires;var Aspect=artemis.Aspect;var DelayedEntityProcessingSystem=artemis.systems.DelayedEntityProcessingSystem;var Mapper=artemis.annotations.Mapper;var ExpiringSystem=function(_super){__extends(ExpiringSystem,_super);function ExpiringSystem(){_super.call(this,Aspect.getAspectForAll(Expires))}ExpiringSystem.prototype.processDelta=function(e,accumulatedDelta){var expires=this.em.get(e);expires.delay-=accumulatedDelta};
ExpiringSystem.prototype.processExpired=function(e){e.deleteFromWorld()};ExpiringSystem.prototype.getRemainingDelay=function(e){var expires=this.em.get(e);return expires.delay};__decorate([Mapper(Expires)],ExpiringSystem.prototype,"em");return ExpiringSystem}(DelayedEntityProcessingSystem);systems.ExpiringSystem=ExpiringSystem})(systems=brokenspork.systems||(brokenspork.systems={}))})(brokenspork||(brokenspork={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var brokenspork;
(function(brokenspork){var systems;(function(systems){var Health=brokenspork.components.Health;var Position=brokenspork.components.Position;var Aspect=artemis.Aspect;var EntityProcessingSystem=artemis.systems.EntityProcessingSystem;var Mapper=artemis.annotations.Mapper;var HealthRenderSystem=function(_super){__extends(HealthRenderSystem,_super);function HealthRenderSystem(){_super.call(this,Aspect.getAspectForAll(Position,Health))}HealthRenderSystem.prototype.initialize=function(){};HealthRenderSystem.prototype.begin=
function(){};HealthRenderSystem.prototype.processEach=function(e){var position=this.pm.get(e);var health=this.hm.get(e);var percentage=Math.round(health.health/health.maximumHealth*100)};HealthRenderSystem.prototype.end=function(){};__decorate([Mapper(Position)],HealthRenderSystem.prototype,"pm");__decorate([Mapper(Health)],HealthRenderSystem.prototype,"hm");return HealthRenderSystem}(EntityProcessingSystem);systems.HealthRenderSystem=HealthRenderSystem})(systems=brokenspork.systems||(brokenspork.systems=
{}))})(brokenspork||(brokenspork={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var brokenspork;
(function(brokenspork){var systems;(function(systems){var Position=brokenspork.components.Position;var Sprite=brokenspork.components.Sprite;var VoidEntitySystem=artemis.systems.VoidEntitySystem;var Mapper=artemis.annotations.Mapper;var HudRenderSystem=function(_super){__extends(HudRenderSystem,_super);function HudRenderSystem(){_super.call(this)}HudRenderSystem.prototype.initialize=function(){};HudRenderSystem.prototype.begin=function(){};HudRenderSystem.prototype.processSystem=function(){};HudRenderSystem.prototype.end=
function(){};__decorate([Mapper(Position)],HudRenderSystem.prototype,"pm");__decorate([Mapper(Sprite)],HudRenderSystem.prototype,"sm");return HudRenderSystem}(VoidEntitySystem);systems.HudRenderSystem=HudRenderSystem})(systems=brokenspork.systems||(brokenspork.systems={}))})(brokenspork||(brokenspork={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var brokenspork;
(function(brokenspork){var systems;(function(systems){var Position=brokenspork.components.Position;var Velocity=brokenspork.components.Velocity;var Aspect=artemis.Aspect;var EntityProcessingSystem=artemis.systems.EntityProcessingSystem;var Mapper=artemis.annotations.Mapper;var MovementSystem=function(_super){__extends(MovementSystem,_super);function MovementSystem(){_super.call(this,Aspect.getAspectForAll(Position,Velocity))}MovementSystem.prototype.processEach=function(e){var position=this.pm.get(e);
var velocity=this.vm.get(e);if(velocity==null)return;position.x+=velocity.vectorX*this.world.delta;position.y+=velocity.vectorY*this.world.delta};__decorate([Mapper(Position)],MovementSystem.prototype,"pm");__decorate([Mapper(Velocity)],MovementSystem.prototype,"vm");return MovementSystem}(EntityProcessingSystem);systems.MovementSystem=MovementSystem})(systems=brokenspork.systems||(brokenspork.systems={}))})(brokenspork||(brokenspork={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var brokenspork;
(function(brokenspork){var systems;(function(systems){var ParallaxStar=brokenspork.components.ParallaxStar;var Position=brokenspork.components.Position;var Constants=brokenspork.core.Constants;var Aspect=artemis.Aspect;var IntervalEntityProcessingSystem=artemis.systems.IntervalEntityProcessingSystem;var Mapper=artemis.annotations.Mapper;var ParallaxStarRepeatingSystem=function(_super){__extends(ParallaxStarRepeatingSystem,_super);function ParallaxStarRepeatingSystem(){_super.call(this,Aspect.getAspectForAll(ParallaxStar,
Position),1)}ParallaxStarRepeatingSystem.prototype.processEach=function(e){var position=this.pm.get(e);if(position.y<-Constants.FRAME_HEIGHT/2)position.y=Constants.FRAME_HEIGHT/2};__decorate([Mapper(Position)],ParallaxStarRepeatingSystem.prototype,"pm");return ParallaxStarRepeatingSystem}(IntervalEntityProcessingSystem);systems.ParallaxStarRepeatingSystem=ParallaxStarRepeatingSystem})(systems=brokenspork.systems||(brokenspork.systems={}))})(brokenspork||(brokenspork={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var brokenspork;
(function(brokenspork){var systems;(function(systems){var Bounds=brokenspork.components.Bounds;var Health=brokenspork.components.Health;var Position=brokenspork.components.Position;var Velocity=brokenspork.components.Velocity;var Constants=brokenspork.core.Constants;var Aspect=artemis.Aspect;var IntervalEntityProcessingSystem=artemis.systems.IntervalEntityProcessingSystem;var Mapper=artemis.annotations.Mapper;var RemoveOffscreenShipsSystem=function(_super){__extends(RemoveOffscreenShipsSystem,_super);
function RemoveOffscreenShipsSystem(){_super.call(this,Aspect.getAspectForAll(Velocity,Position,Health,Bounds),5)}RemoveOffscreenShipsSystem.prototype.processEach=function(e){var position=this.pm.get(e);var bounds=this.bm.get(e);if(position.y<-Constants.FRAME_HEIGHT/2-bounds.radius)e.deleteFromWorld()};__decorate([Mapper(Position)],RemoveOffscreenShipsSystem.prototype,"pm");__decorate([Mapper(Bounds)],RemoveOffscreenShipsSystem.prototype,"bm");return RemoveOffscreenShipsSystem}(IntervalEntityProcessingSystem);
systems.RemoveOffscreenShipsSystem=RemoveOffscreenShipsSystem})(systems=brokenspork.systems||(brokenspork.systems={}))})(brokenspork||(brokenspork={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var brokenspork;
(function(brokenspork){var systems;(function(systems){var ScaleAnimation=brokenspork.components.ScaleAnimation;var Sprite=brokenspork.components.Sprite;var Aspect=artemis.Aspect;var EntityProcessingSystem=artemis.systems.EntityProcessingSystem;var Mapper=artemis.annotations.Mapper;var ScaleAnimationSystem=function(_super){__extends(ScaleAnimationSystem,_super);function ScaleAnimationSystem(){_super.call(this,Aspect.getAspectForAll(ScaleAnimation))}ScaleAnimationSystem.prototype.processEach=function(e){var scaleAnimation=
this.sa.get(e);if(scaleAnimation.active){var sprite=this.sm.get(e);sprite.scaleX+=scaleAnimation.speed*this.world.delta;sprite.scaleY=sprite.scaleX;if(sprite.scaleX>scaleAnimation.max){sprite.scaleX=scaleAnimation.max;scaleAnimation.active=false}else if(sprite.scaleX<scaleAnimation.min){sprite.scaleX=scaleAnimation.min;scaleAnimation.active=false}}};__decorate([Mapper(ScaleAnimation)],ScaleAnimationSystem.prototype,"sa");__decorate([Mapper(Sprite)],ScaleAnimationSystem.prototype,"sm");return ScaleAnimationSystem}(EntityProcessingSystem);
systems.ScaleAnimationSystem=ScaleAnimationSystem})(systems=brokenspork.systems||(brokenspork.systems={}))})(brokenspork||(brokenspork={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var brokenspork;
(function(brokenspork){var systems;(function(systems){var SoundEffect=brokenspork.components.SoundEffect;var EFFECT=brokenspork.components.EFFECT;var Aspect=artemis.Aspect;var EntityProcessingSystem=artemis.systems.EntityProcessingSystem;var Mapper=artemis.annotations.Mapper;var SoundEffectSystem=function(_super){__extends(SoundEffectSystem,_super);function SoundEffectSystem(){_super.call(this,Aspect.getAspectForAll(SoundEffect))}SoundEffectSystem.prototype.initialize=function(){};SoundEffectSystem.prototype.processEach=
function(e){var soundEffect=this.se.get(e);switch(soundEffect.effect){case EFFECT.PEW:break;case EFFECT.ASPLODE:break;case EFFECT.SMALLASPLODE:break;default:break}e.removeComponentInstance(soundEffect);e.changedInWorld()};__decorate([Mapper(SoundEffect)],SoundEffectSystem.prototype,"se");return SoundEffectSystem}(EntityProcessingSystem);systems.SoundEffectSystem=SoundEffectSystem})(systems=brokenspork.systems||(brokenspork.systems={}))})(brokenspork||(brokenspork={}));
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};
var __decorate=this&&this.__decorate||function(decorators,target,key,desc){if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")return Reflect.decorate(decorators,target,key,desc);switch(arguments.length){case 2:return decorators.reduceRight(function(o,d){return d&&d(o)||o},target);case 3:return decorators.reduceRight(function(o,d){return d&&d(target,key),void 0},void 0);case 4:return decorators.reduceRight(function(o,d){return d&&d(target,key,o)||o},desc)}};var brokenspork;
(function(brokenspork){var systems;(function(systems){var HashMap=artemis.utils.HashMap;var Position=brokenspork.components.Position;var Sprite=brokenspork.components.Sprite;var Aspect=artemis.Aspect;var EntitySystem=artemis.EntitySystem;var Bag=artemis.utils.Bag;var Mapper=artemis.annotations.Mapper;var SpriteRenderSystem=function(_super){__extends(SpriteRenderSystem,_super);function SpriteRenderSystem(){_super.call(this,Aspect.getAspectForAll(Position,Sprite))}SpriteRenderSystem.prototype.initialize=
function(){this.regions=new HashMap;cc.spriteFrameCache.addSpriteFrames("res/images-packed/pack.plist");var textureAtlas=cc.spriteFrameCache;for(var name in textureAtlas._spriteFrames){var r=textureAtlas._spriteFrames[name];this.regions.put(name,r)}this.regionsByEntity=new Bag;this.sortedEntities=new Array};SpriteRenderSystem.prototype.begin=function(){};SpriteRenderSystem.prototype.checkProcessing=function(){return true};SpriteRenderSystem.prototype.processEntities=function(entities){for(var i=0;this.sortedEntities.length>
i;i++)this.processEach(this.sortedEntities[i])};SpriteRenderSystem.prototype.processEach=function(e){if(this.pm.has(e)){var position=this.pm.getSafe(e);var sprite=this.sm.get(e)}};SpriteRenderSystem.prototype.end=function(){};SpriteRenderSystem.prototype.inserted=function(e){var _this=this;var sprite=this.sm.get(e);this.regionsByEntity.set(e.getId(),this.regions.get(sprite.name));this.sortedEntities.push(e);this.sortedEntities.sort(function(e1,e2){var s1=_this.sm.get(e1);var s2=_this.sm.get(e2);return s1.layer-
s2.layer})};SpriteRenderSystem.prototype.removed=function(e){this.regionsByEntity.set(e.getId(),null);var index=this.sortedEntities.indexOf(e);if(index!=-1)this.sortedEntities.splice(index,1)};__decorate([Mapper(Position)],SpriteRenderSystem.prototype,"pm");__decorate([Mapper(Sprite)],SpriteRenderSystem.prototype,"sm");return SpriteRenderSystem}(EntitySystem);systems.SpriteRenderSystem=SpriteRenderSystem})(systems=brokenspork.systems||(brokenspork.systems={}))})(brokenspork||(brokenspork={}));var brokenspork;
(function(brokenspork){var core;(function(core){var MathUtils=artemis.utils.MathUtils;var Bounds=brokenspork.components.Bounds;var ColorAnimation=brokenspork.components.ColorAnimation;var Expires=brokenspork.components.Expires;var Health=brokenspork.components.Health;var ParallaxStar=brokenspork.components.ParallaxStar;var Player=brokenspork.components.Player;var Position=brokenspork.components.Position;var ScaleAnimation=brokenspork.components.ScaleAnimation;var SoundEffect=brokenspork.components.SoundEffect;
var Sprite=brokenspork.components.Sprite;var Velocity=brokenspork.components.Velocity;var Layer=brokenspork.components.Layer;var EFFECT=brokenspork.components.EFFECT;var GroupManager=artemis.managers.GroupManager;var EntityFactory=function(){function EntityFactory(){}EntityFactory.createPlayer=function(game,world,x,y){var e=world.createEntity();var position=new Position;position.x=x;position.y=y;e.addComponent(position);var sprite=new Sprite;sprite.name="fighter";sprite.r=93;sprite.g=255;sprite.b=
129;sprite.layer=Layer.ACTORS_3;e.addComponent(sprite);game.addChild(sprite.sprite_);var velocity=new Velocity;velocity.vectorX=0;velocity.vectorY=0;e.addComponent(velocity);var bounds=new Bounds;bounds.radius=43;e.addComponent(bounds);e.addComponent(new Player);world.getManager(GroupManager).add(e,core.Constants.Groups.PLAYER_SHIP);return e};EntityFactory.createPlayerBullet=function(game,world,x,y){var e=world.createEntity();var position=new Position;position.x=x;position.y=y;e.addComponent(position);
var sprite=new Sprite;sprite.name="bullet";sprite.layer=Layer.PARTICLES;e.addComponent(sprite);var velocity=new Velocity;velocity.vectorY=800;e.addComponent(velocity);var bounds=new Bounds;bounds.radius=5;e.addComponent(bounds);var expires=new Expires;expires.delay=5;e.addComponent(expires);var sf=new SoundEffect;sf.effect=EFFECT.PEW;e.addComponent(sf);world.getManager(GroupManager).add(e,core.Constants.Groups.PLAYER_BULLETS);return e};EntityFactory.createEnemyShip=function(game,world,name,layer,
health,x,y,velocityX,velocityY,boundsRadius){var e=world.createEntity();var position=new Position;position.x=x;position.y=y;e.addComponent(position);var sprite=new Sprite;sprite.name=name;sprite.r=255;sprite.g=0;sprite.b=142;sprite.layer=layer;e.addComponent(sprite);var velocity=new Velocity;velocity.vectorX=velocityX;velocity.vectorY=velocityY;e.addComponent(velocity);var bounds=new Bounds;bounds.radius=boundsRadius;e.addComponent(bounds);var h=new Health;h.health=h.maximumHealth=health;e.addComponent(h);
world.getManager(GroupManager).add(e,core.Constants.Groups.ENEMY_SHIPS);return e};EntityFactory.createSmallExplosion=function(game,world,x,y){var e=this.createExplosion(game,world,x,y,.1);var sf=new SoundEffect;sf.effect=EFFECT.SMALLASPLODE;e.addComponent(sf);return e};EntityFactory.createBigExplosion=function(game,world,x,y){var e=this.createExplosion(game,world,x,y,.5);var sf=new SoundEffect;sf.effect=EFFECT.ASPLODE;e.addComponent(sf);return e};EntityFactory.createExplosion=function(game,world,
x,y,scale){var e=world.createEntity();var position=new Position;position.x=x;position.y=y;e.addComponent(position);var sprite=new Sprite;sprite.name="explosion";sprite.scaleX=sprite.scaleY=scale;sprite.r=255;sprite.g=216;sprite.b=0;sprite.a=128;sprite.layer=Layer.PARTICLES;e.addComponent(sprite);var expires=new Expires;expires.delay=.5;e.addComponent(expires);var scaleAnimation=new ScaleAnimation;scaleAnimation.active=true;scaleAnimation.max=scale;scaleAnimation.min=scale/100;scaleAnimation.speed=
-3;scaleAnimation.repeat=false;e.addComponent(scaleAnimation);return e};EntityFactory.createStar=function(game,world){var e=world.createEntity();var position=new Position;position.x=MathUtils.random(-core.Constants.FRAME_WIDTH/2,core.Constants.FRAME_WIDTH/2);position.y=MathUtils.random(-core.Constants.FRAME_HEIGHT/2,core.Constants.FRAME_HEIGHT/2);e.addComponent(position);var sprite=new Sprite;sprite.name="particle";sprite.scaleX=sprite.scaleY=MathUtils.random(.5,1);sprite.a=MathUtils.random(.1,.5);
sprite.layer=Layer.BACKGROUND;e.addComponent(sprite);var velocity=new Velocity;velocity.vectorY=MathUtils.random(-10,-60);e.addComponent(velocity);e.addComponent(new ParallaxStar);var colorAnimation=new ColorAnimation;colorAnimation.alphaAnimate=true;colorAnimation.repeat=true;colorAnimation.alphaSpeed=MathUtils.random(.2,.7);colorAnimation.alphaMin=.1;colorAnimation.alphaMax=.5;e.addComponent(colorAnimation);return e};EntityFactory.createParticle=function(game,world,x,y){var e=world.createEntity();
var position=new Position;position.x=x;position.y=y;e.addComponent(position);var sprite=new Sprite;sprite.name="particle";sprite.scaleX=sprite.scaleY=MathUtils.random(.5,1);sprite.r=255;sprite.g=216;sprite.b=0;sprite.a=1;sprite.layer=Layer.PARTICLES;e.addComponent(sprite);var radians=MathUtils.random(2*Math.PI);var magnitude=MathUtils.random(400);var velocity=new Velocity;velocity.vectorX=magnitude*Math.cos(radians);velocity.vectorY=magnitude*Math.sin(radians);e.addComponent(velocity);var expires=
new Expires;expires.delay=1;e.addComponent(expires);var colorAnimation=new ColorAnimation;colorAnimation.alphaAnimate=true;colorAnimation.alphaSpeed=-1;colorAnimation.alphaMin=0;colorAnimation.alphaMax=1;colorAnimation.repeat=false;e.addComponent(colorAnimation);return e};return EntityFactory}();core.EntityFactory=EntityFactory})(core=brokenspork.core||(brokenspork.core={}))})(brokenspork||(brokenspork={}));var brokenspork;
(function(brokenspork){var core;(function(core){var CollisionSystem=brokenspork.systems.CollisionSystem;var ColorAnimationSystem=brokenspork.systems.ColorAnimationSystem;var EntitySpawningTimerSystem=brokenspork.systems.EntitySpawningTimerSystem;var ExpiringSystem=brokenspork.systems.ExpiringSystem;var HealthRenderSystem=brokenspork.systems.HealthRenderSystem;var HudRenderSystem=brokenspork.systems.HudRenderSystem;var MovementSystem=brokenspork.systems.MovementSystem;var ParallaxStarRepeatingSystem=
brokenspork.systems.ParallaxStarRepeatingSystem;var RemoveOffscreenShipsSystem=brokenspork.systems.RemoveOffscreenShipsSystem;var ScaleAnimationSystem=brokenspork.systems.ScaleAnimationSystem;var SoundEffectSystem=brokenspork.systems.SoundEffectSystem;var SpriteRenderSystem=brokenspork.systems.SpriteRenderSystem;var GroupManager=artemis.managers.GroupManager;var GameScreen=function(){function GameScreen(game){this.game=game;this.world=new artemis.World;this.world.setManager(new GroupManager);this.world.setSystem(new MovementSystem);
this.world.setSystem(new SoundEffectSystem);this.world.setSystem(new CollisionSystem(game));this.world.setSystem(new ExpiringSystem);this.world.setSystem(new EntitySpawningTimerSystem(game));this.world.setSystem(new ParallaxStarRepeatingSystem);this.world.setSystem(new ColorAnimationSystem);this.world.setSystem(new ScaleAnimationSystem);this.world.setSystem(new RemoveOffscreenShipsSystem);this.spriteRenderSystem=this.world.setSystem(new SpriteRenderSystem,true);this.healthRenderSystem=this.world.setSystem(new HealthRenderSystem,
true);this.hudRenderSystem=this.world.setSystem(new HudRenderSystem,true);this.world.initialize();core.EntityFactory.createPlayer(this.game,this.world,0,0).addToWorld();for(var i=0;500>i;i++)core.EntityFactory.createStar(this.game,this.world).addToWorld()}GameScreen.prototype.render=function(delta){this.world.setDelta(delta);this.world.process();this.spriteRenderSystem.process();this.healthRenderSystem.process();this.hudRenderSystem.process()};GameScreen.ASPECT_RATIO=core.Constants.FRAME_WIDTH/core.Constants.FRAME_HEIGHT;
return GameScreen}();core.GameScreen=GameScreen})(core=brokenspork.core||(brokenspork.core={}))})(brokenspork||(brokenspork={}));var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};var brokenspork;
(function(brokenspork){var core;(function(core){var SpaceshipWarrior=function(_super){__extends(SpaceshipWarrior,_super);function SpaceshipWarrior(scene){_super.call(this);this.scene=scene;return new (cc.Layer.extend(this))}SpaceshipWarrior.start=function(){var scene=new cc.Scene;scene.addChild(new SpaceshipWarrior(scene));return scene};SpaceshipWarrior.prototype.ctor=function(){this._super();this.gameScreen=new core.GameScreen(this);this.scheduleUpdate()};SpaceshipWarrior.prototype.update=function(time){this.gameScreen.render(time)};
return SpaceshipWarrior}(CCLayer);core.SpaceshipWarrior=SpaceshipWarrior})(core=brokenspork.core||(brokenspork.core={}))})(brokenspork||(brokenspork={}));(function(root,factory){if("function"===typeof define&&undefined.amd)define(factory);else if("object"==typeof exports)module.exports=factory();else root["brokenspork"]=factory()})(this,function(){return brokenspork});
